<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.32">

  <meta name="author" content="Dr.&nbsp;Mario Reutter (slides adapted from Dr.&nbsp;Lea Hildebrandt)">
  <title>Biostatistics – 08 Modeling Relationships</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto-816793a8a4a837d14f6ea458e2f1c5cb.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">08 Modeling Relationships</h1>
  <p class="subtitle"></p><div class="line-block">Julius-Maximilians-University Würzburg<br>
Course: “Biostatistics”<br>
Translational Neuroscience</div><p></p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Dr.&nbsp;Mario Reutter (slides adapted from Dr.&nbsp;Lea Hildebrandt) 
</div>
</div>
</div>

</section>
<section id="agenda" class="title-slide slide level1 center">
<h1>Agenda</h1>
<ul>
<li>Categorical Relationships (Chi² tests)</li>
<li>Continuous Relationships (Correlations)</li>
<li>Group Comparisons (t-tests &amp; ANOVA)</li>
</ul>
</section>

<section>
<section id="modeling-categorical-relationships" class="title-slide slide level1 center">
<h1>Modeling <em>Categorical</em> Relationships</h1>
<div class="cell">
<style type="text/css">
code.sourceCode {
  font-size: 1.4em;
}

div.cell-output-stdout {
  font-size: 1.4em;
}
</style>
</div>
<aside class="notes">
<p>Now that we have covered the basics, we will apply them and turn to the question how to model particular relationships.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="chi²-test-general" class="slide level2">
<h2>Chi² Test: General</h2>
<p>We will first focus on modeling <em>categorical</em> relationships (i.e., of variables that are qualitative!).</p>
<div class="fragment">
<p>These data are usually expressed in terms of <strong>counts</strong>.</p>
</div>
<div class="fragment">
<p><strong>Example: Candy colors</strong></p>
<p>Bag of candy: 30 chocolates, 33 licorices, and 37 gumballs.</p>
</div>
<div class="fragment">
<p>Is the distribution fair (i.e., 1/3rd of the bag for each candy) and the fact that there are only 30 chocolates within expectations?</p>
</div>
<div class="fragment">
<p><strong>What is the likelihood that the count would come out this way (or even more extreme) if the true probability of each candy type is the same?</strong></p>
<aside class="notes">
<p>Counts: For each combination of variables, how many observations do we have?</p>
<p>If the machine really sorts on average 1/3 of each in each bag? How much is due to chance?</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="chi²-test-one-variable" class="slide level2">
<h2>Chi² Test: One Variable</h2>
<p>The Chi² test checks whether observed counts differ from expected values (<span class="math inline">\(H_0\)</span>).</p>
<p><span class="math display">\[
\chi^2 = \sum_i\frac{(observed_i - expected_i)^2}{expected_i}
\]</span></p>
<div class="fragment">
<p>The null hypothesis in our example is that the proportion of each type of candy is equal (1/3 or ~33.33).</p>
<p>If we plug in our values from above, we would calculate <span class="math inline">\(\chi^2\)</span> like this:</p>
<p><span class="math display">\[ \chi^2 = \frac{(30 - 33.33)^2}{33.33} + \frac{(33 - 33.33)^2}{33.33} + \frac{(37 - 33.33)^2}{33.33} = 0.74 \]</span></p>
<aside class="notes">
<p>take the difference between observed and expected (33.33), square it, divide it by expected 33.33 and add everything up</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="chi²-test-general-1" class="slide level2">
<h2>Chi² Test: General</h2>
<p>On its own, the <span class="math inline">\(\chi^2\)</span> statistic is not interpretable - it depends on its distribution.</p>
<p>The shape of the <span class="math inline">\(\chi^2\)</span> distribution depends on the <em>degrees of freedom</em> (much like the <em>t</em> distribution), which is the number of category levels <span class="math inline">\(k-1\)</span>.</p>

<img data-src="W8_ModelingRelationships_files/figure-revealjs/unnamed-chunk-3-1.png" width="960" class="r-stretch"></section>
<section id="chi2-test-candies" class="slide level2">
<h2>Chi2 Test: Candies</h2>
<p>For the candy example, we use a chi-squared distribution with <span class="math inline">\(DFs = 2\)</span> (3 candy categories minus one → green line). If we’d look at the distribution and found <span class="math inline">\(\chi^2 = .74\)</span> on the x-axis (dashed red line), we would see that it does not fall far into the tail of the distribution but is rather in the middle. If we calculate the <em>p</em>-value, we’d get <span class="math inline">\(P(\chi^2 &gt; .74) = 0.691\)</span>.</p>

<img data-src="W8_ModelingRelationships_files/figure-revealjs/unnamed-chunk-4-1.png" width="960" class="r-stretch"><p>It is thus not particularly surprising to find this distribution of candies and we would not reject <span class="math inline">\(H_0\)</span> (equal proportions).</p>
</section>
<section id="contingency-tables-and-the-two-way-test" class="slide level2">
<h2>Contingency Tables and the Two-Way Test</h2>
<p>The <span class="math inline">\(\chi^2\)</span> test is also used to test whether two categorical variables are related to each other.</p>
<div class="fragment">
<p>Example: Are Black drivers more likely to be pulled over by police than white drivers?</p>
<p>We have two variables: Skin color (black vs white) and being pulled over (true vs.&nbsp;false). We can represent the data in a <em>contingency table</em> (remember: the <code>count()</code> function was helpful to do this in R):</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top" data-quarto-postprocess="true">
<caption>Contingency table for police search data</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">searched</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Black</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">White</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Black (relative)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">White (relative)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">36244</td>
<td style="text-align: right;">239241</td>
<td style="text-align: right;">0.1295298</td>
<td style="text-align: right;">0.8550062</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">1219</td>
<td style="text-align: right;">3108</td>
<td style="text-align: right;">0.0043565</td>
<td style="text-align: right;">0.0111075</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="contingency-tables-and-the-two-way-test-1" class="slide level2">
<h2>Contingency Tables and the Two-Way Test</h2>
<p>If there is no relationship between skin color and being searched, the frequencies of searches would be proportional to the frequencies of skin color. This would be our expected values. We can determine them using probabilities:</p>
<table class="caption-top">
<thead>
<tr class="header">
<th></th>
<th>Black</th>
<th>White</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Not searched</strong></td>
<td><span class="math inline">\(P(\neg S)*P(B)\)</span></td>
<td><span class="math inline">\(P(\neg S)*P(W)\)</span></td>
<td><span class="math inline">\(P(\neg S)\)</span></td>
</tr>
<tr class="even">
<td><strong>Searched</strong></td>
<td><span class="math inline">\(P(S)*P(B)\)</span></td>
<td><span class="math inline">\(P(S)*P(W)\)</span></td>
<td><span class="math inline">\(P(S)\)</span></td>
</tr>
<tr class="odd">
<td></td>
<td><span class="math inline">\(P(B)\)</span></td>
<td><span class="math inline">\(P(W)\)</span></td>
<td><span class="math inline">\(100\%\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Remember</strong>: You can only multiply two probabilities to get their conjoint probability if they are independent. Here, we <em>assume independence to calculate expected values</em> and then check how much our observed values <em>deviate from independence</em>.</p>
<aside class="notes">
<p>Probabilities: Because we expect the variables to be <em>unrelated</em>, we can calculate the <strong>joint probability</strong> as the product of the <strong>marginal probabilities</strong>:<br>
<span class="math inline">\(P(X \cap Y) = P(X) * P(Y)\)</span></p>
<p>Marginal probabilities are the prob of each event occuring regardless of other events (in the margins of the table!)</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="chi²-test-with-two-variables" class="slide level2">
<h2>Chi² Test with Two Variables</h2>
<p>If we compute the standardized squared difference between observed and expected values, we can sum them up to get <span class="math inline">\(\chi^2 = 828.3\)</span></p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top" data-quarto-postprocess="true">
<caption>Contingency table for police search data</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">searched</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">driver_race</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">expected</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">stdSqDiff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">Black</td>
<td style="text-align: right;">36244</td>
<td style="text-align: right;">36883.67</td>
<td style="text-align: right;">11.09</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">Black</td>
<td style="text-align: right;">1219</td>
<td style="text-align: right;">579.33</td>
<td style="text-align: right;">706.31</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">White</td>
<td style="text-align: right;">239241</td>
<td style="text-align: right;">238601.33</td>
<td style="text-align: right;">1.71</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">White</td>
<td style="text-align: right;">3108</td>
<td style="text-align: right;">3747.67</td>
<td style="text-align: right;">109.18</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We can then compute the <em>p</em>-value using a chi-squared distribution with <span class="math inline">\(DF = (levels_{var1} - 1) * (levels_{var2} - 1) = (2-1) * (2-1) = 1\)</span></p>
</section>
<section id="chi²-test-with-two-variables-in-r" class="slide level2">
<h2>Chi² Test with Two Variables in <code>R</code></h2>
<p>We can calculate a <span class="math inline">\(\chi^2\)</span> test easily in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="fu">chisq.test</span>(summaryDf2wayTable, <span class="at">correct =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  summaryDf2wayTable
X-squared = 828.3, df = 1, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<p>The results indicate that the data are highly unlikely if there was no true relationship between skin color and police searches! We would thus reject <span class="math inline">\(H_0\)</span>.</p>
<aside class="notes">
<p>DF: computing the expected frequencies requires three values: total number of observations and marg probs each variable. thus only one of the four values can vary freely.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="chi²-test-with-two-variables-interpretation" class="slide level2">
<h2>Chi² Test with Two Variables: Interpretation</h2>
<p>Question: What is the direction of the observed relationship?</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top" data-quarto-postprocess="true">
<caption>Contingency table for police search data</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">searched</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">driver_race</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">expected</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">stdSqDiff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">Black</td>
<td style="text-align: right;">36244</td>
<td style="text-align: right;">36883.67</td>
<td style="text-align: right;">11.09</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">Black</td>
<td style="text-align: right;">1219</td>
<td style="text-align: right;">579.33</td>
<td style="text-align: right;">706.31</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">White</td>
<td style="text-align: right;">239241</td>
<td style="text-align: right;">238601.33</td>
<td style="text-align: right;">1.71</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">White</td>
<td style="text-align: right;">3108</td>
<td style="text-align: right;">3747.67</td>
<td style="text-align: right;">109.18</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="standardized-residuals" class="slide level2">
<h2>Standardized Residuals</h2>
<p>If we want to know not only whether but also <em>how</em> the data differ from what we would expect under <span class="math inline">\(H_0\)</span>, we can examine the <strong>residuals</strong> of the model.</p>
<p>The residuals tell us for each cell how much the observed data deviates from the expected data.</p>
<p>To make the residuals better comparable, we will look at the <em>standardized</em> residuals:</p>
<p><span class="math display">\[
\text{standardized residual}_{ij} = \frac{observed_{ij} - expected_{ij}}{\sqrt{expected_{ij}}}
\]</span></p>
<p>where <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> are the rows and columns respectively.</p>
</section>
<section id="standardized-residuals-1" class="slide level2">
<h2>Standardized Residuals</h2>
<p><strong>Negative residuals</strong> indicate an observed value <strong>smaller</strong> than expected.</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top" data-quarto-postprocess="true">
<caption>Summary of standardized residuals for police stop data</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">searched</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">driver_race</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Standardized residuals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">Black</td>
<td style="text-align: right;">-3.330746</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">Black</td>
<td style="text-align: right;">26.576456</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">White</td>
<td style="text-align: right;">1.309550</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">White</td>
<td style="text-align: right;">-10.449072</td>
</tr>
</tbody>
</table>
</div>
</div>
<aside class="notes">
<p>raw residuals depend on number of observations!</p>
<p>Black individuals are searched way more often than expected –&gt; helps us intepret significant results.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="odds-ratios" class="slide level2">
<h2>Odds Ratios</h2>
<p>Alternatively, we can represent the relative likelihood of different outcomes as odds ratios:</p>
<p><span class="math display">\[
odds_{searched|black} = \frac{N(searched\cap black)}{N(\neg searched \cap black)} = \frac{1219}{36244} = 0.034
\]</span></p>
<p><span class="math display">\[
odds_{searched|white} = \frac{N(searched \cap white)}{N(\neg searched \cap white)} = \frac{3108}{239241} = 0.013
\]</span></p>
<p><span class="math display">\[
odds\ ratio = \frac{odds(searched|black)}{odds(searched|white)} = 2.59
\]</span></p>
<p>The odds of being searched are 2.59x higher for Black vs.&nbsp;white drivers!</p>
</section>
<section id="simpsons-paradox" class="slide level2">
<h2>Simpson’s Paradox</h2>
<p>The Simpson’s Paradox is a great example of misleading summaries.</p>
<div class="fragment">
<p>If we look at the baseball data below, we see that David Justice has a better batting average in every single year, but Derek Jeter has a better overall batting average:</p>
<table class="caption-top">
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th>Player</th>
<th>1995</th>
<th></th>
<th>1996</th>
<th></th>
<th>1997</th>
<th></th>
<th>Combined</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Jeter</td>
<td>12/48</td>
<td>.250</td>
<td>183/582</td>
<td>.314</td>
<td>190/654</td>
<td>.291</td>
<td>385/1284</td>
<td><strong>.300</strong></td>
</tr>
<tr class="even">
<td>Justice</td>
<td>104/411</td>
<td><strong>.253</strong></td>
<td>45/140</td>
<td><strong>.321</strong></td>
<td>163/495</td>
<td><strong>.329</strong></td>
<td>312/1046</td>
<td>.298</td>
</tr>
</tbody>
</table>
<p>How can this be?</p>
</div>
<div class="fragment">
<p><strong>Simpson’s Paradox</strong>: A pattern is present in the combined dataset but may be different in subsets of the data.</p>
</div>
<div class="fragment">
<p>Happens if another (lurking) variable changes across subsets (e.g., the number of at-bats, i.e., the denominator).</p>
<aside class="notes">
<p>batting average: hits/at bats</p>
<p>1995: in general low batting averages, Justice had a lot of at-bats =&gt; diminishes total combined value more strongly than for Jeter.</p>
<p>1996: both players were above their average but Jeter had way more at-bats =&gt; more important for the overall average.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="simpsons-paradox-more-intuitive" class="slide level2">
<h2>Simpson’s Paradox: More intuitive</h2>
<p>While typing on a keyboard, what is the relationship between speed (words per minute) and accuracy (% correct words)? (positive, negative, or none)</p>
<div class="fragment">
<p><br>
</p>
<p>If I try to type faster, I will make more errors ⇒ speed-accuracy trade-off (negative association)</p>
<p>People who are better at typing usually are both faster and make fewer mistakes (positive association)</p>
</div>
<div class="fragment">
<p><br>
</p>
<p>Answer: It depends</p>
<ul>
<li><strong>Within a person</strong>, the relationship between speed and accuracy is negative. My own skill is limited, I can either use it for speed or accuracy.</li>
<li><strong>Between persons</strong>, the relationship is positive due to inter-individual differences in overall typing skill.</li>
</ul>
<aside class="notes">
<p>Usually, when leveling up, people don’t put all their skill points in only speed or accuracy.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section></section>
<section>
<section id="modeling-continuous-relationships" class="title-slide slide level1 center">
<h1>Modeling <em>Continuous</em> Relationships</h1>

</section>
<section id="example-income-inequality-and-hate-crimes" class="slide level2">
<h2>Example: Income Inequality and Hate Crimes</h2>
<p>We want to look at a dataset that was used for an analysis of the relationship between income inequality (<em>Gini index</em>) and the prevalence of hate crimes in the USA.</p>

<img data-src="W8_ModelingRelationships_files/figure-revealjs/unnamed-chunk-12-1.png" width="960" class="r-stretch"><p>It looks like there is a positive relationship between the variables. How can we quantify this relationship?</p>
</section>
<section id="covariance-and-correlation" class="slide level2">
<h2>Covariance and Correlation</h2>
<p>Variance (single variable): <span class="math inline">\(s^2 = \frac{\sum_{i=1}^n (x_i - \bar{x})^2}{N - 1}\)</span></p>
<p><strong>Covariance</strong> (two variables): <span class="math inline">\(covariance = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{N - 1}\)</span></p>
<div class="fragment">
<p>“Is there a relation between the deviations of two different variables (from their means) across observations?”</p>
</div>
<div class="fragment">
<p>Covariance will be far from 0 if data points share a relationship. Positive values for same direction, negative values for opposite directions.</p>
</div>
<div class="fragment">
<p>Covariance varies with overall level of variance in the data ⇒ hard to compare different relationships</p>
</div>
<div class="fragment">
<p><br>
</p>
<p><strong>Correlation coefficient</strong> (Pearson correlation): Scales the covariance by the standard deviations of the two variables and thus standardizes it (→ <span class="math inline">\(r\)</span> varies between <span class="math inline">\(-1\)</span> and <span class="math inline">\(1\)</span> ⇒ comparability!)</p>
<p><span class="math display">\[
r = \frac{covariance}{s_xs_y} = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{(N - 1)s_x s_y}
\]</span></p>
<aside class="notes">
<p>Insight: Variance is the covariance of a variable with itself.</p>
<p>Covariance depends on dataset and even on scaling of variables!<br>
e.g.&nbsp;relationship between body height and weight ⇒ Using m vs.&nbsp;cm for height will change variance and thus covariance even though the relationship should be identical (same data)</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="hypothesis-testing-for-correlations" class="slide level2">
<h2>Hypothesis Testing for Correlations</h2>
<p>The correlation between income inequality and hate crimes is <span class="math inline">\(r = .42\)</span>, which seems to be a reasonably strong (positive) relationship.</p>
<div class="fragment">
<p>We can test whether such a relationship could occur by chance, even if there is actually no relationship. In this case, our null hypothesis is <span class="math inline">\(H_0: r = 0\)</span>.</p>
</div>
<div class="fragment">
<p>To test whether there is a significant relationship, we can transform the <span class="math inline">\(r\)</span> statistic into a <span class="math inline">\(t\)</span> statistic:</p>
<p><span class="math display">\[
t_r = \frac{r\sqrt{N-2}}{\sqrt{1-r^2}}
\]</span></p>
</div>
</section>
<section id="correlation-in-r" class="slide level2">
<h2>Correlation in R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a><span class="co"># perform correlation test on hate crime data</span></span>
<span id="cb3-2"><a></a><span class="fu">cor.test</span>(</span>
<span id="cb3-3"><a></a>  hateCrimes<span class="sc">$</span>avg_hatecrimes_per_100k_fbi,</span>
<span id="cb3-4"><a></a>  hateCrimes<span class="sc">$</span>gini_index</span>
<span id="cb3-5"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  hateCrimes$avg_hatecrimes_per_100k_fbi and hateCrimes$gini_index
t = 3.2182, df = 48, p-value = 0.002314
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.1619097 0.6261922
sample estimates:
      cor 
0.4212719 </code></pre>
</div>
</div>
<p>The <em>p</em>-value is quite small, which indicates that it is quite unlikely to find an <span class="math inline">\(r\)</span> value this high or more extreme with 48 degress of freedom. We would thus reject <span class="math inline">\(H_0: r = 0\)</span>.</p>

<aside class="notes">
<p>subsetting with $!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><div>
<p>Side note: There are more beautiful &amp; convenient ways to do this in R. We will cover this in the next session.</p>
</div></aside></section>
<section id="robust-correlations" class="slide level2">
<h2>Robust Correlations</h2>
<p>In the plot, we have seen an <strong>outlier</strong>: The District of Columbia was quite different from the other data points.</p>
<div class="fragment">
<p>The Pearson’s correlation coefficient <span class="math inline">\(r\)</span> is highly sensitive to outliers, see this hypothetical example:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="W8_ModelingRelationships_files/figure-revealjs/unnamed-chunk-14-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="robust-correlation-2" class="slide level2">
<h2>Robust Correlation 2</h2>
<p>We can use a different correlation coefficient, which is less sensitive to outliers: <strong>Spearman correlation</strong>.</p>
<p>It is based on ranking (i.e., ordering) the data and using the ranks (instead of the original data) for the correlation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a><span class="fu">cor.test</span>(hateCrimes<span class="sc">$</span>avg_hatecrimes_per_100k_fbi,</span>
<span id="cb5-2"><a></a>  hateCrimes<span class="sc">$</span>gini_index,</span>
<span id="cb5-3"><a></a>  <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  hateCrimes$avg_hatecrimes_per_100k_fbi and hateCrimes$gini_index
S = 20146, p-value = 0.8221
alternative hypothesis: true rho is not equal to 0
sample estimates:
       rho 
0.03261836 </code></pre>
</div>
</div>
<p>The correlation has now dropped from <span class="math inline">\(.42\)</span> to <span class="math inline">\(.03\)</span> and is no longer significant.</p>
<p>Of course, a ranked correlation can also obscure true effects that critically depend on the scale of the data. When in doubt, try both and discuss reasons for differences.</p>
<aside class="notes">
<p>Without outlier: perfectly <em>negative</em> correlation, with outlier: highly positive!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="correlation-and-causation" class="slide level2">
<h2>Correlation and Causation</h2>
<p>Doing a well controlled, randomized experiment (RCT) is extremely helpful to gather causal evidence. However, it is not always possible or ethical to do an experiment!</p>
<p>Without an experiment, we can still collect <em>observational</em> data. However, if we correlate two observed variables, we <em>can’t</em> conclude that one causes the other: They (likely) share a relationship but there could also be a third variable that causes both (or even more complex causal structures).</p>
</section>
<section id="causal-graphs" class="slide level2">
<h2>Causal Graphs</h2>
<p>If we have observational data, <strong>causal graphs</strong> can be helpful for interpreting causality:</p>
<div class="columns">
<div class="column" style="width:40%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="images/dag_latent_example.png" width="350"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:60%;">
<p><em>Circle</em>: observed variables<br>
<em>rectangle</em>: latent (unobservable) variable<br>
</p>
<p><em>Green arrow</em>: positive relationship,<br>
<em>red</em>: negative</p>
<p><em>ExamGrade</em> and <em>FinishTime</em> seem negatively related if we ignore other variables!<br>
(“Hand in your exam early to improve your grade!”)</p>
<p><em>Knowledge</em> = theoretical mediator<br>
<em>StudyTime</em> = proxy for knowledge</p>
<p>If we control for StudyTime (which approximates individual knowledge), we find out that ExamGrade and FinishTime are (causally) unrelated!</p>
</div></div>
<aside class="notes">
<p>We have briefly talked about <em>causation</em> in week 1</p>
<p>Think of data/questions where it is impossible/unethical!<br>
abused children and brain development!<br>
(3rd var: family stress -&gt; less intellectual engagement –&gt; poorer brain dev)</p>
<p>Correlation: s.th. is probably causing s.th. else but not clear what causes what!</p>
<p>DAG:<br>
green: pos, red: net<br>
circle: observed, rect: latent (unobservable)<br>
ExamGrade and FinishTime seem neg related if we ignore others<br>
knowledge = mediates<br>
StudyTime = proxy for knowledge, if we “control” it/hold it constant/only use people with same amount, we would see that EG and FT are unrelated!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="comparing-means-group-differences" class="title-slide slide level1 center">
<h1>Comparing Means (Group Differences)</h1>

</section>
<section id="testing-a-single-mean-one-sample-t-test" class="slide level2">
<h2>Testing a Single Mean (One sample <em>t</em>-Test)</h2>
<p>We sometimes might want to know whether a single value, the mean of a group, differs from a specific value, e.g.&nbsp;whether the blood pressure in the sample differs from or is bigger than 80.</p>
<div class="fragment">
<p>We can test this using the <span class="math inline">\(t\)</span>-test, which we have already encountered in the “Hypothesis Testing” session!</p>
<p><span class="math display">\[
t = \frac{\hat{X} - \mu}{SEM}
\]</span></p>
<p><span class="math display">\[
SEM = \frac{\hat{\sigma}}{\sqrt{n}}
\]</span></p>
<p><span class="math inline">\(\hat{X}\)</span> is the mean of our sample, <span class="math inline">\(\mu\)</span> the hypothesized population mean (e.g.&nbsp;the value we want to test against, such as 80 for the blood pressure example).</p>
</div>
</section>
<section id="one-sample-t-test-in-r" class="slide level2">
<h2>One sample <em>t</em>-Test in <code>R</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a><span class="fu">t.test</span>(<span class="at">x=</span>NHANES_adult<span class="sc">$</span>BPDiaAve, <span class="at">mu=</span><span class="dv">80</span>, <span class="at">alternative=</span><span class="st">'greater'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  NHANES_adult$BPDiaAve
t = -55.23, df = 4599, p-value = 1
alternative hypothesis: true mean is greater than 80
95 percent confidence interval:
 69.1588     Inf
sample estimates:
mean of x 
 69.47239 </code></pre>
</div>
</div>
<div class="fragment">
<p>The observed mean is actually much below 80, providing no evidence for our <em>directional</em> alternative hypothesis that it would be greater than 80 ⇒ the <em>p</em> values is (rounded to) 1.</p>
</div>
<div class="fragment">
<p>If we had tested two-sidedly, we would have found a significant result. It may seem tempting now to create a story around an altered, non-directional alternative hypothesis, which is why it is important to preregister your hypotheses and analyses.</p>
<aside class="notes">
<p>(The <span class="math inline">\(t\)</span> statistic thus asks how large the deviation of sample mean from the expected value with respect to the sampling variability of the mean!)</p>
<p>We tested the one-sided alternative (&gt;) and the blood pressure in the sample is much lower than 80, so it is far from significance</p>
<p>We can’t interpret the <span class="math inline">\(p\)</span>-value as evidence in favor of <span class="math inline">\(H_0\)</span> (i.e.&nbsp;larger <span class="math inline">\(p\)</span>-value! vs non.sign) –&gt; Bayes!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="comparing-two-means-independent-samples-t-test" class="slide level2">
<h2>Comparing Two Means (Independent samples <em>t</em>-Test)</h2>
<p>More often, we want to know whether there is a difference between the means of <em>two groups</em>.</p>
<p>Example: Do regular marijuana smokers watch <em>more</em> television?<br>
</p>
<p><span class="math inline">\(H_0\)</span> = marijuana smokers watch less or equally often TV,<br>
<span class="math inline">\(H_A\)</span> = marijuana smokers watch more TV.</p>
<p>If the observations are independent (i.e.&nbsp;you really have two unrelated groups), you can use a very similar formula to calculate the <span class="math inline">\(t\)</span> statistic:</p>
<p><span class="math display">\[
t = \frac{\bar{X_1} - \bar{X_2}}{\sqrt{\frac{S_1^2}{n_1} + \frac{S_2^2}{n_2}}}
\]</span></p>
<p>whereby <span class="math inline">\(\hat{X_1}\)</span> and <span class="math inline">\(\hat{X_2}\)</span> are the group means, <span class="math inline">\(S_1^2\)</span> and <span class="math inline">\(S_2^2\)</span> the group variances, and <span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_2\)</span> the group sizes.</p>
</section>
<section id="independent-samples-t-test-in-r" class="slide level2">
<h2>Independent samples <em>t</em>-Test in <code>R</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a><span class="co"># t.test(NHANES_sample$TVHrsNum[NHANES_sample$RegularMarij=="Yes"],</span></span>
<span id="cb9-2"><a></a><span class="co">#        NHANES_sample$TVHrsNum[NHANES_sample$RegularMarij=="No"],</span></span>
<span id="cb9-3"><a></a><span class="co">#        alternative = "greater")</span></span>
<span id="cb9-4"><a></a></span>
<span id="cb9-5"><a></a><span class="fu">with</span>(NHANES_sample, <span class="co">#only refer to data once using "with" function</span></span>
<span id="cb9-6"><a></a>     <span class="fu">t.test</span>(TVHrsNum[RegularMarij<span class="sc">==</span><span class="st">"Yes"</span>],</span>
<span id="cb9-7"><a></a>            TVHrsNum[RegularMarij<span class="sc">==</span><span class="st">"No"</span>],</span>
<span id="cb9-8"><a></a>            <span class="at">alternative =</span> <span class="st">"greater"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  TVHrsNum[RegularMarij == "Yes"] and TVHrsNum[RegularMarij == "No"]
t = 1.2147, df = 116.9, p-value = 0.1135
alternative hypothesis: true difference in means is greater than 0
95 percent confidence interval:
 -0.09866006         Inf
sample estimates:
mean of x mean of y 
  2.30000   2.02963 </code></pre>
</div>
</div>
<div class="fragment">
<aside class="notes">
<p>DV: continuous, IV: categories</p>
<p>n.s. (differs from book), although mean is higher in Yes, not significantly different!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="comparing-dependent-observations-paired-samples-t-test" class="slide level2">
<h2>Comparing Dependent Observations (Paired samples <em>t</em>-test)</h2>
<p>If we have repeated observations of the same subject (i.e., a within-subject design), we might want to compare the same subject thus on multiple, <em>repeated measurements</em>.</p>
<div class="fragment">
<p>If we want to test whether blood pressure differs between the first and second measurement session across individuals, we can use a <strong>paired</strong> <span class="math inline">\(t\)</span><strong>-test</strong>.</p>
<p>Side note: A paired <span class="math inline">\(t\)</span>-test is equivalent to a one-sample <span class="math inline">\(t\)</span>-test, when using the paired differences (<span class="math inline">\(X_2 - X_1\)</span>) as <span class="math inline">\(\hat{X}\)</span> and testing them against a value of 0 (if we expect no difference for <span class="math inline">\(H_0\)</span>) for <span class="math inline">\(\mu\)</span>.</p>
<aside class="notes">
<p>important: If we run an independent sample t-test, it would probably be n.s.! (check out book)</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="paired-samples-t-test-in-r" class="slide level2">
<h2>Paired samples <em>t</em>-test in <code>R</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a><span class="fu">t.test</span>(NHANES_sample<span class="sc">$</span>BPSys1, NHANES_sample<span class="sc">$</span>BPSys2, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  NHANES_sample$BPSys1 and NHANES_sample$BPSys2
t = 2.7369, df = 199, p-value = 0.006763
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 0.2850857 1.7549143
sample estimates:
mean difference 
           1.02 </code></pre>
</div>
</div>
</section>
<section id="comparing-more-than-two-means" class="slide level2">
<h2>Comparing More Than Two Means</h2>
<p>Often, we want to compare more than two means, e.g.&nbsp;different treatment groups or time points.</p>
<p>Example: Different treatments for blood pressure</p>

<img data-src="W8_ModelingRelationships_files/figure-revealjs/unnamed-chunk-24-1.png" width="480" class="r-stretch"></section>
<section id="analysis-of-variance-anova" class="slide level2">
<h2>Analysis of Variance (ANOVA)</h2>
<p><span class="math inline">\(H_0\)</span>: all means are equal<br>
<span class="math inline">\(H_A\)</span>: not all means are equal (e.g.&nbsp;at least one differs)</p>
<div class="fragment">
<p>We can <em>partition</em> the variance of the data into different parts:</p>
<p><span class="math inline">\(SS_{total}\)</span> = total variance in the data<br>
<span class="math inline">\(SS_{model}\)</span> = Variance explained by the model<br>
<span class="math inline">\(SS_{error}\)</span> = Variance <em>not</em> explained by the model</p>
</div>
<div class="fragment">
<p>We can use those to calculate the <em>mean squares</em> for the model and the error:</p>
<p><span class="math inline">\(MS_{model} =\frac{SS_{model}}{df_{model}}= \frac{SS_{model}}{p-1}\)</span> (<span class="math inline">\(p\)</span> is the number of factor levels or groups)</p>
<p><span class="math inline">\(MS_{error} = \frac{SS_{error}}{df_{error}} = \frac{SS_{error}}{N - p}\)</span> (<span class="math inline">\(N\)</span> is the total sample size across groups)</p>

<aside class="notes">
<p>quite common analysis! We will just scratch the surface</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
<aside><div>
<p><span class="math inline">\(SS\)</span> = Sum of Squares, remember that the variance is the sum of the squared deviation of an observation to the mean</p>
<p><span class="math inline">\(MS\)</span> = Mean (Sum of) Squares: How much variance per degree of freedom?</p>
</div></aside></section>
<section id="anova-in-r" class="slide level2">
<h2>ANOVA in <code>R</code></h2>
<p>In R, we would run an ANOVA like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a></a>df <span class="ot">&lt;-</span></span>
<span id="cb13-2"><a></a>  df <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a></a>  <span class="fu">mutate</span>(<span class="at">group2=</span><span class="fu">fct_relevel</span>(group,<span class="fu">c</span>(<span class="st">"placebo"</span>,<span class="st">"drug1"</span>,<span class="st">"drug2"</span>)))</span>
<span id="cb13-4"><a></a><span class="co"># reorder the factor levels so that "placebo" is the control condition/intercept!</span></span>
<span id="cb13-5"><a></a>  </span>
<span id="cb13-6"><a></a> </span>
<span id="cb13-7"><a></a><span class="co"># test model without separate duymmies</span></span>
<span id="cb13-8"><a></a>lmResultAnovaBasic <span class="ot">&lt;-</span> <span class="fu">lm</span>(sysBP <span class="sc">~</span> group2, <span class="at">data=</span>df)</span>
<span id="cb13-9"><a></a><span class="fu">anova</span>(lmResultAnovaBasic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: sysBP
           Df  Sum Sq Mean Sq F value   Pr(&gt;F)    
group2      2  2115.6 1057.81  10.714 5.83e-05 ***
Residuals 105 10366.7   98.73                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The <span class="math inline">\(F\)</span>-statistic (also called <em>omnibus test</em>) actually tests our overall hypothesis of no difference between conditions.</p>
</section>
<section id="anova-in-r-1" class="slide level2">
<h2>ANOVA in <code>R</code></h2>
<p>We now know that not all groups should be considered equal. But where is the difference?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a></a><span class="fu">summary</span>(lmResultAnovaBasic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sysBP ~ group2, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-29.0838  -7.7452  -0.0978   7.6872  23.4313 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  141.595      1.656  85.502  &lt; 2e-16 ***
group2drug1  -10.237      2.342  -4.371 2.92e-05 ***
group2drug2   -2.027      2.342  -0.865    0.389    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 9.936 on 105 degrees of freedom
Multiple R-squared:  0.1695,    Adjusted R-squared:  0.1537 
F-statistic: 10.71 on 2 and 105 DF,  p-value: 5.83e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a></a><span class="co"># emmeans(lmResultAnovaBasic, "group2" ) #run this to get means and CIs for each group</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can see a <span class="math inline">\(t\)</span>-test for every drug against the placebo (remember we used <code>fct_relevel</code> for this). The <span class="math inline">\(t\)</span>-tests show that drug1 (but not drug2) differs significantly from placebo.</p>
</section>
<section id="anova-in-r-comments" class="slide level2">
<h2>ANOVA in <code>R</code>: Comments</h2>
<p>In this simple example, we could have skipped the omnibus test (<code>anova()</code>) and just looked at the <code>summary()</code>.</p>
<p>In practise, you will often run ANOVAs with several factors (grouping variables) that all have a multitude of factor levels (subgroups).<br>
Think: Two groups of drugs and one placebo across four time points (before, during, after, &amp; follow-up). This quickly creates too many possible comparisons to keep track of.</p>
<p>This complicates things furhter because then you can also have <em>interactions</em> between variables (e.g., drug1 does not work better but faster than drug2).</p>
<p>For these examples, it is helpful to first get an overall statement if a factor (or an interaction of factors) has an influence on the results. If this is the case, you can run the individual t-tests for this factor to get a more detailed look.</p>
<!--
## ANOVA side notes
In `R`, there are different functions that you can use to run an ANOVA besides `lm()`, which have different advantages and disadvantages (functions like `ezANOVA()` from the `ez` packages or functions from the `afex` package might be helpful).

Just like with the $t$-test, there's also a distinction between *between-subjects* and *within-subjects* (i.e., *repeated measures ANOVA*). The previous example contained just *between-subjects* measures, i.e. different groups without repeated measures. We will talk about other options later, but see the packages mentioned above as well for functional parameters called, e.g., `within`.

::: notes
Dummy coded (explicitly):


::: {.cell}
::: {.cell-output .cell-output-stdout}

```

Call:
lm(formula = sysBP ~ d1 + d2, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-29.0838  -7.7452  -0.0978   7.6872  23.4313 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  141.595      1.656  85.502  < 2e-16 ***
d1           -10.237      2.342  -4.371 2.92e-05 ***
d2            -2.027      2.342  -0.865    0.389    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 9.936 on 105 degrees of freedom
Multiple R-squared:  0.1695,    Adjusted R-squared:  0.1537 
F-statistic: 10.71 on 2 and 105 DF,  p-value: 5.83e-05
```


:::
:::


$t$-tests: dummy coded = 0 vs. 1\
- control for multiple comparisons! (later)\
- if we wanted to compare the two drugs, we'd have to dummy code/relevel differently or use follow-up comparisons like with emmeans()

$F$: Is our model better than a simple model that just includes the intercept? In this case placebo...
:::
-->
</section></section>
<section id="thanks" class="title-slide slide level1 center">
<h1>Thanks!</h1>
<p>Learning objectives:</p>
<ul>
<li><p>What are <em>contingency tables</em> and how do we use <span class="math inline">\(\chi^2\)</span>-tests to assess a significant relationship between <em>categorical</em> variables?</p></li>
<li><p>Be able to describe what a <em>correlation coefficient</em> is as well as compute and interpret it.</p></li>
<li><p>Know what a <span class="math inline">\(t\)</span>-test &amp; ANOVA is and how to compute and interpret them.</p></li>
</ul>
<p>Next:</p>
<p>Practical exercises in R!</p>


</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,

        height: 720,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/Hillea\.github\.io\/biostats\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>