<!DOCTYPE html>
<html lang="en"><head>
<script src="W6_ProbabilityR_files/libs/clipboard/clipboard.min.js"></script>
<script src="W6_ProbabilityR_files/libs/quarto-html/tabby.min.js"></script>
<script src="W6_ProbabilityR_files/libs/quarto-html/popper.min.js"></script>
<script src="W6_ProbabilityR_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="W6_ProbabilityR_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="W6_ProbabilityR_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="W6_ProbabilityR_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="W6_ProbabilityR_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.353">

  <meta name="author" content="Dr.&nbsp;Mario Reutter (slides adapted from Dr.&nbsp;Lea Hildebrandt)">
  <title>06 Probability &amp; Sampling in R</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="W6_ProbabilityR_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="W6_ProbabilityR_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="W6_ProbabilityR_files/libs/revealjs/dist/theme/quarto.css">
  <link href="W6_ProbabilityR_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="W6_ProbabilityR_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="W6_ProbabilityR_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="W6_ProbabilityR_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="W6_ProbabilityR_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="W6_ProbabilityR_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">06 Probability &amp; Sampling in R</h1>
  <p class="subtitle"></p><p>Julius-Maximilians-University Würzburg<br>
Course: “Biostatistics”<br>
Translational Neuroscience</p><p></p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Dr.&nbsp;Mario Reutter (slides adapted from Dr.&nbsp;Lea Hildebrandt) 
</div>
</div>
</div>

</section>
<section>
<section id="probability" class="title-slide slide level1 center">
<h1>Probability</h1>
<p>We already covered classic probability theory, including conditional probability.</p>
<p>Today, we will go more into depth about different <strong>probability distributions</strong>.</p>
<div class="fragment">
<p>A probability distribution is similar to a frequency distribution: The difference is that the <strong>probability distribution</strong> reflects the <em>theory</em> and the <strong>frequency distribution</strong> the <em>observed data</em> (i.e., frequencies are used to <em>approximate</em> probabilities)</p>
</div>
<div class="fragment">
<p><strong>Simulations</strong> can be used to get (an approximation of) a probability distribution!<br>
We don’t have to conduct an experiment, e.g., tossing a coin 100x, but can rather simulate it using R!</p>
<div class="cell">
<style type="text/css">
code.sourceCode {
  font-size: 1.4em;
}

div.cell-output-stdout {
  font-size: 1.4em;
}
</style>
</div>
<aside class="notes">
<p>freq dist: How many times did an event occur? (e.g.&nbsp;flipping a coin, getting tails)</p>
<p>prob dist: How many times should it have occurred? 50% but also realistic lower and higher values!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="the-uniform-distribution" class="slide level2">
<h2>The Uniform Distribution</h2>
<p>In a <strong>uniform distribution</strong>, each possible outcome has an equal chance of occurring.</p>
<div class="fragment">
<p>If we have a hat with 12 paper slips with names, each name has an equal chance (<span class="math inline">\(p = \frac{1}{12} \approx .08\)</span>) of being drawn:</p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="W6_ProbabilityR_files/figure-revealjs/unnamed-chunk-2-1.png" width="960"></p>
</div>
</div>
</div>
</section>
<section id="the-binomial-distribution" class="slide level2">
<h2>The Binomial Distribution</h2>
<p>The <strong>binomial</strong> (“two categories”) <strong>distribution</strong> is used for <em>discrete</em> data with <em>two</em> possible outcomes (e.g., flipping a coin). It models the number of <em>successes</em> being observed (e.g., heads), given the probability of success (0.5 for fair coins) and the number of observations (flips of a coin, e.g., 10).</p>
<div class="fragment">
<p>How many heads (successes) should we expect and with what probability?</p>
<p>We can simulate 10 coin flips (or dice) each 10.000 times and count the number of heads (out of the 10). We can use this distribution to work out the probability of different outcomes, e.g., getting at least 3 heads (or 6s) out of 10 tosses (dice rolls).</p>
<div class="columns">
<div class="column">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="W6_ProbabilityR_files/figure-revealjs/unnamed-chunk-3-1.png" width="384"></p>
</div>
</div>
</div><div class="column">
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="W6_ProbabilityR_files/figure-revealjs/unnamed-chunk-4-1.png" width="384"></p>
</div>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>success: whatever you want, also an “artificial” dichotomization like “roll a 6” vs.&nbsp;“roll no 6”</p>
<p>add up probabilities &gt;=3 or 1 - P(X &lt;= 2)</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="the-normal-distribution" class="slide level2">
<h2>The Normal Distribution</h2>
<p>The <strong>normal distribution</strong> is very common in statistics (i.e., in the real world). It (roughly) reflects the probability of any value occurring for a <em>continuous</em> variable, such as height.</p>

<img data-src="images/norm_dist_height.PNG" width="485" class="r-stretch quarto-figure-center"><p class="caption">Normal distribution of height</p><div class="fragment">
<p>The normal distribution is always <em>symmetrical</em><br>
=&gt; equal probability of observations above and below the mean.<br>
=&gt; the mean, median, and mode are all equal!</p>
</div>
</section>
<section id="normal-distribution-2" class="slide level2">
<h2>Normal Distribution 2</h2>
<p>We can also use simulations to approximate a normal distribution. This simulation shows that increasing the sample size will get closer to a normal distribution:</p>

<img data-src="images/normal_dist.gif" class="r-stretch quarto-figure-center"><p class="caption">A simulation of an experiment collecting height data from 5000 participants.</p></section></section>
<section id="r" class="title-slide slide level1 center">
<h1>R</h1>
<p>Open RStudio and load your Biostats R project. Create a new script called <code>Probability.R</code>.</p>
</section>

<section>
<section id="distributions" class="title-slide slide level1 center">
<h1>Distributions</h1>
<p>We are starting with exercises about the three distributions we just got know: uniform, binomial, and normal distribution.</p>
</section>
<section id="using-the-uniform-distribution" class="slide level2">
<h2>Using the Uniform Distribution</h2>
<p>We can use <code>runif</code> for a uniform distribution of <em>continuous</em> (numerical) values or<br>
<code>sample</code> for a uniform distribution of <em>discrete</em> (numerical or text) values.</p>
<ol type="1">
<li>Draw a random decimal number between 0 and 1</li>
<li>Draw 100 random decimal numbers between 0 and 10 and calculate their mean.</li>
<li>Draw 50 random <strong>integer</strong> numbers between 1 and 10 and calculate their mean.</li>
<li>Draw who may have the first turn during board game night: Anna, Barbara, Christina, or Dana.</li>
<li>Produce a random order of all the names of Anna, Barbara, Christina, and Dana.</li>
</ol>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">#1</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>) <span class="co">#default parameters are already set to min=0 and max=1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05572353</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co">#2</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">100</span>, <span class="at">max=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">mean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.42688</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co">#3</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">size=</span><span class="dv">50</span>, <span class="at">replace=</span>T) <span class="sc">%&gt;%</span> <span class="fu">mean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.74</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co">#4</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Anna"</span>, <span class="st">"Barbara"</span>, <span class="st">"Christina"</span>, <span class="st">"Dana"</span>), <span class="at">size=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Barbara"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">#5</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Anna"</span>, <span class="st">"Barbara"</span>, <span class="st">"Christina"</span>, <span class="st">"Dana"</span>)) <span class="co">#by default, sample draws all elements in random order</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Christina" "Dana"      "Anna"      "Barbara"  </code></pre>
</div>
</div>
</div>
</section>
<section id="using-the-binomial-distribution" class="slide level2">
<h2>Using the Binomial Distribution</h2>
<div class="fragment">
<div class="columns">
<div class="column">
<ul>
<li><code>dbinom()</code>: the <strong>density distribution</strong> gives you the probability of <strong>exactly</strong> <span class="math inline">\(x_i\)</span> successes given the number of trials and the probability of success on a single trial: <span class="math inline">\(P(X = x_i)\)</span> (e.g., what’s the probability of flipping 8/10 heads with a fair coin?)</li>
</ul>
<p><br>
</p>
<ul>
<li><p><code>pbinom()</code>: the <strong>(cumulative) probability distribution</strong> gives you the <em>cumulative</em> probability of getting <strong>a maximum of</strong> <span class="math inline">\(x_i\)</span> successes: <span class="math inline">\(P(X \le x_i)\)</span> (e.g., getting 5 or fewer heads out of 10 flips).</p></li>
<li><p><code>qbinom()</code>: the <strong>quantile function</strong> gives you the number of success (x-axis) corresponding to a given <strong>cumulative</strong> probability: <span class="math inline">\(X(P = P_i)\)</span> (e.g., A maximum of how many heads do you have to expect if you want at least an event probability of 25%?). This is the inverse function of <code>pbinom()</code>.</p></li>
</ul>
<p><strong>Note:</strong> Be aware of the difference between success probability <span class="math inline">\(p\)</span>, the probability of the density distribution <span class="math inline">\(P(X = x_i)\)</span>, and the probability of the cumulative probability distribution <span class="math inline">\(P(X \le x_i)\)</span></p>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="W6_ProbabilityR_files/figure-revealjs/unnamed-chunk-6-1.png" width="384"></p>
</div>
</div>
</div>
</div>
<aside class="notes">
<ol type="1">
<li>What’s the probability of getting exactly 5 heads on 10 flips?</li>
<li>What’s the probability of getting 0 to 2 heads on 10 flips?</li>
<li>What’s the probability of getting at least 8 heads on 10 flips?</li>
</ol>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="using-the-binomial-distribution-2" class="slide level2">
<h2>Using the Binomial Distribution 2</h2>
<p>Now in R:</p>
<ol type="1">
<li>What’s the probability of getting exactly 5 heads on 10 flips?</li>
<li>What’s the probability of getting 0 to 2 heads on 10 flips?</li>
<li>What’s the probability of getting at least 8 heads on 10 flips?</li>
</ol>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co">#1</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2460938</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co">#2 (indirect way)</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">prob=</span><span class="fl">0.5</span>) <span class="sc">%&gt;%</span> <span class="fu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0546875</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co">#2 (direct way)</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="fu">pbinom</span>(<span class="at">q =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>) <span class="co">#P(X &lt;= q)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0546875</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co">#3 (careful: minus 1)</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="fu">pbinom</span>(<span class="at">q =</span> <span class="dv">8-1</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>, <span class="at">lower.tail =</span> F) <span class="co">#P(X &gt; q) = 1 - P(X &lt;= q)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0546875</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p><strong>Note</strong>: The binomial distribution is only symmetrical for <span class="math inline">\(p = 50\%\)</span>.<br>
That’s why “a maximum of 2 heads” (0, 1, or 2) has the same probability as “at least 8 heads” (8, 9, or 10).</p>
<aside class="notes">
<ul>
<li><p><code>x</code>: the number of ‘heads’ of which we want to know the probability.</p></li>
<li><p><code>size</code>: the number of trials (flips) we are simulating; in this case, 10 flips.</p></li>
<li><p><code>prob</code>: the probability of ‘heads’ on one trial. 50% far a fair coin.</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!--
## Using the Binomial Distribution 3

**Activity 3**: `pbinom()`

What is the probability of getting max. 2 heads out of 10 coin flips?

. . .

We want to know the **cumulative probability** (*max.* **2** heads out of **10**, which includes 0 and 1 - so it is the sum of those three probabilities).

Run this code:


::: {.cell}

```{.r .cell-code}
pbinom(q = 2, size = 10, prob = 0.5)
```

::: {.cell-output .cell-output-stdout}
```
[1] 0.0546875
```
:::

```{.r .cell-code}
# note: before the first argument was x, but here it's called q
```
:::


The probability of getting 2 heads or less is 0.05!

::: notes
show!
:::

## Using the Binomial Distribution 4

Now it's your turn: *What is the probability of getting **7 or more** heads on 10 flips?*

. . .

If we simply put in `q = 7`, we get the probability of everything up to 7 (blue bars in plot). This is not what we want.


::: {.cell}

```{.r .cell-code}
pbinom(q = 7, size = 10, prob = .5) 
```

::: {.cell-output .cell-output-stdout}
```
[1] 0.9453125
```
:::
:::

::: {.cell}
::: {.cell-output-display}
![](W6_ProbabilityR_files/figure-revealjs/unnamed-chunk-10-1.png){width=384}
:::
:::


. . .

You might remember from the first (input) lesson on probability that the sum of all probabilities is 1 and you can use this to calculate the "upper" probabilities of 7, 8, 9, and 10 combined. For this, we calculate the probability of getting max. 6 heads and subtract this value from 1:


::: {.cell}

```{.r .cell-code}
1 - pbinom(q = 6, size = 10, prob = .5)
```

::: {.cell-output .cell-output-stdout}
```
[1] 0.171875
```
:::
:::


. . .

Alternatively, we can also hand over another argument to the `pbinom()` function: `lower.tail=FALSE`.


::: {.cell}

```{.r .cell-code}
pbinom(q = 6, size = 10, prob = .5, lower.tail = FALSE)
```

::: {.cell-output .cell-output-stdout}
```
[1] 0.171875
```
:::
:::

## Using the Binomial Distribution 5
-->
</div>
</section>
<section id="using-the-binomial-distribution-3" class="slide level2">
<h2>Using the Binomial Distribution 3</h2>
<p>Now let’s use the <em>quantile function</em> <code>qbinom()</code>!</p>
<p>Imagine a friend wants to bet you on tossing a coin and bets that it will be tails. You suspect she has a coin that is not fair and it will be more likely that it turns up as tails.</p>
<p>Your friend agrees that you can toss the coin 10 times to test it before you have to give your bet.<br>
you want to find out whether the coin is fair and ask yourself: <strong>What is the minimum number of heads that is acceptable if it is fair?</strong></p>
<p>We choose a probability so low that it is unlikely to get a result lower than that if the coin was fair. We will use a typical value for statistical significance: 0.05 (or in 5% of cases we will find a lower value by chance if the coin was fair).</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">qbinom</span>(<span class="at">p =</span> .<span class="dv">05</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p>In this case, the probability of success is now called <code>prob</code> because <code>p</code> is now used for the probability cut-off we want to set. This is unnecessarily confusing :(</p>
</div>
<div class="fragment">
<p>If we run the code, we get a value of 2. This means that 2 heads is the first time that the cumulative probability function reaches <strong>at least</strong> 5% . Thus, if we get <strong>less than</strong> two heads out of the ten tosses, we could conclude that the coin is likely biased (there is only a 5% chance that this would happen if the coin was fair). You would probably not bet with your friend!</p>
</div>
<div class="fragment">
<p><strong>Note:</strong> This is a bad way to test the fairness of a coin (it’s just for illustration of <code>qbinom</code>)! Rather demand that you win at tails (if the coin is fair, your friend shouldn’t mind).</p>
</div>
</section>
<section id="using-the-normal-distribution" class="slide level2">
<h2>Using the Normal Distribution</h2>
<p>For every probability distribution, R provides similar functions starting with <code>d</code>, <code>p</code>, or <code>q</code>. For the normal distribution, those are:</p>
<div>
<ul>
<li class="fragment"><p><code>dnorm()</code>: <em>density function</em>, for calculating the <em>density</em> (<strong>not probability!</strong>) of a specific value. Only useful for plotting.</p></li>
<li class="fragment"><p><code>pnorm()</code>: <em>cumulative probability</em> or <em>distribution function</em>, for calculating the probability of getting at least (or at most) a specific value.</p></li>
<li class="fragment"><p><code>qnorm()</code>: <em>quantile function</em>, for calculating the specific value associated with a given cumulative probability.</p></li>
</ul>
</div>
<div class="fragment">
<p>For the next activities, we will use means and SDs of height from the Scottish Health Survey (2008).</p>
</div>
</section>
<section id="using-the-normal-distribution-2" class="slide level2">
<h2>Using the Normal Distribution 2</h2>
<p>Calculate the probability of meeting a Scottish woman who is as tall or taller than the average Scottish man.</p>
<p>Which function would you use?</p>
<p><em>Hint</em>: You want to know how likely it is that you get a value as extreme or extremer than a specific value (the average height of men) within the distribution for women.</p>
<p>What we know:</p>
<ul>
<li><p>average female height = 163.8, SD = 6.931</p></li>
<li><p>average male height = 176.2, SD = 6.748</p></li>
<li><p>We want to know “at least as tall as”</p></li>
</ul>
<div class="fragment">
<p>We need the <code>pnorm()</code> function. Fill in the values instead of the <code>NULL</code>s.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">pnorm</span>(<span class="at">q =</span> <span class="cn">NULL</span>, <span class="at">mean =</span> <span class="cn">NULL</span>, <span class="at">sd =</span> <span class="cn">NULL</span>, <span class="at">lower.tail =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">pnorm</span>(<span class="at">q =</span> <span class="fl">176.2</span>, <span class="at">mean =</span> <span class="fl">163.8</span>, <span class="at">sd =</span> <span class="fl">6.931</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03680228</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p><strong>Note</strong>: For continuous distributions, we don’t have to distinguish between “taller than” and “at least as tall”. <span class="math inline">\(P(X \le x_i) = P(X &lt; x_i)\)</span>! (Because the probability of one specific value like 176.2000000 m is exactly 0)</p>
</div>
<div class="fragment">
<p><strong>Also note</strong>: The SD of the distribution of males is not relevant for this question.</p>
<aside class="notes">
<p>Don’t do this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">pnorm</span>(<span class="at">q =</span> <span class="fl">176.2</span>, <span class="at">mean =</span> <span class="fl">163.8</span>, <span class="at">sd =</span> <span class="fl">6.931</span>, <span class="at">lower.tail =</span> F) <span class="sc">+</span> </span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="fu">dnorm</span>(<span class="at">x =</span> <span class="fl">176.2</span>, <span class="at">mean =</span> <span class="fl">163.8</span>, <span class="at">sd =</span> <span class="fl">6.931</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04841892</code></pre>
</div>
</div>
<p>You cannot add a probability and a density together! Just <code>pnorm(q = 176.2, mean = 163.8, sd = 6.931, lower.tail = F)</code> is the correct answer!</p>
<p>When we say “What’s the probability of a woman being 1.80 m tall?”, we actually mean: “What’s the probability of a person being <strong>between 1.795 and 1.805</strong> m tall?” (since height is usually measured within steps of 1 cm). We can calculate this, e.g.&nbsp;for Scottish women, using: <code>pnorm(q = 180 + c(-.5, .5), mean = 163.8, sd = 6.931) %&gt;% diff()</code> = 0.3%</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="using-the-normal-distribution-3" class="slide level2">
<h2>Using the Normal Distribution 3</h2>
<p>Fiona is a very tall Scottish woman (181.12 cm) who will only date men who are as tall or taller than her. What is the probability of Fiona finding a taller man?</p>
<p>What we know:</p>
<ul>
<li><p>average female height = 163.8, SD = 6.931</p></li>
<li><p>average male height = 176.2, SD = 6.748</p></li>
<li><p>We want to know “tall or taller”</p></li>
<li><p>Fiona’s height = 181.12</p></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">pnorm</span>(<span class="at">q =</span> <span class="fl">181.12</span>, <span class="at">mean =</span> <span class="fl">176.2</span>, <span class="at">sd =</span> <span class="fl">6.748</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2329687</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p><strong>Conclusion</strong>: Fiona shrinks her dating pool to roughly a quarter and may thus consider abandoning beauty standards imposed by society. (Same advice for men, of course)</p>
</div>
<div class="fragment">
<p><br>
</p>
<p>How tall would a Scottish man have to be in order to be in the tallest 5% of the height distribution for Scottish men?</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="fu">qnorm</span>(<span class="at">p =</span> .<span class="dv">05</span>, <span class="at">mean =</span> <span class="fl">176.2</span>, <span class="at">sd =</span> <span class="fl">6.748</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 187.2995</code></pre>
</div>
</div>
</div>
</section></section>
<section>
<section id="simulations" class="title-slide slide level1 center">
<h1>Simulations</h1>
<p>As you saw in last lecture, we can also use similar functions (usually starting with <code>r</code>) to simulate data (i.e., to draw samples from probability distributions).</p>
<p>This can be helpful if we don’t know the “ground truth” or want to quantify uncertainty. We can also use simulations to calculate the power of a study.</p>
<p>With simulations, we define the expected “ground truth” (distribution of the population) and generate data from it.</p>
<div class="fragment">
<p><strong>Example</strong>: We can use <code>rnorm()</code> to simulate data from a normal distribution with given parameters. Here, we will use means and SDs from the Scottish Health Survey (2008) to visualize two normal distributions:</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>men <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">100000</span>, <span class="at">mean =</span> <span class="fl">176.2</span>, <span class="at">sd =</span> <span class="fl">6.748</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a>women <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">100000</span>, <span class="at">mean =</span> <span class="fl">163.8</span>, <span class="at">sd =</span> <span class="fl">6.931</span>)</span>
<span id="cb30-3"><a href="#cb30-3"></a></span>
<span id="cb30-4"><a href="#cb30-4"></a>heights <span class="ot">&lt;-</span> <span class="fu">tibble</span>(men, women) <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">"sex"</span>, <span class="at">values_to =</span> <span class="st">"height"</span>, men<span class="sc">:</span>women)</span>
<span id="cb30-6"><a href="#cb30-6"></a></span>
<span id="cb30-7"><a href="#cb30-7"></a>heights <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">fill =</span> sex)) <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"E"</span>) <span class="sc">+</span></span>
<span id="cb30-10"><a href="#cb30-10"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output-display">
<p><img data-src="W6_ProbabilityR_files/figure-revealjs/unnamed-chunk-19-1.png" width="960"></p>
</div>
</div>
</div>
<p>We could use these data to visualize how much overlap there is between the two distributions of men and women, or to test how big the difference in height needs to be to become significant etc.</p>
<aside class="notes">
<p>We use “real data” as input for the simulations! So the simulations are based on empirical values (means, sd), but we actually draw more observations, 100.000!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="simulate-different-distributions" class="slide level2">
<h2>Simulate Different Distributions</h2>
<p>It is possible to draw data from different distributions:</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>nsamples <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>nhistbins <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb31-3"><a href="#cb31-3"></a></span>
<span id="cb31-4"><a href="#cb31-4"></a><span class="co"># uniform distribution</span></span>
<span id="cb31-5"><a href="#cb31-5"></a>p1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">runif</span>(nsamples)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-6"><a href="#cb31-6"></a>  <span class="fu">ggplot</span>((<span class="fu">aes</span>(x))) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> nhistbins) <span class="sc">+</span> </span>
<span id="cb31-7"><a href="#cb31-7"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Uniform"</span>)</span>
<span id="cb31-8"><a href="#cb31-8"></a></span>
<span id="cb31-9"><a href="#cb31-9"></a><span class="co"># binomial distribution</span></span>
<span id="cb31-10"><a href="#cb31-10"></a>p2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rbinom</span>(nsamples, <span class="dv">20</span>, <span class="fl">0.25</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-11"><a href="#cb31-11"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> nhistbins) <span class="sc">+</span></span>
<span id="cb31-12"><a href="#cb31-12"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Binomial (p=0.25, 20 trials)"</span>)</span>
<span id="cb31-13"><a href="#cb31-13"></a></span>
<span id="cb31-14"><a href="#cb31-14"></a><span class="co"># normal distribution</span></span>
<span id="cb31-15"><a href="#cb31-15"></a>p3 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(nsamples)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-16"><a href="#cb31-16"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> nhistbins) <span class="sc">+</span></span>
<span id="cb31-17"><a href="#cb31-17"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Normal"</span>)</span>
<span id="cb31-18"><a href="#cb31-18"></a></span>
<span id="cb31-19"><a href="#cb31-19"></a><span class="co"># Chi-squared distribution</span></span>
<span id="cb31-20"><a href="#cb31-20"></a>p4 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rchisq</span>(nsamples, <span class="at">df=</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-21"><a href="#cb31-21"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> nhistbins) <span class="sc">+</span></span>
<span id="cb31-22"><a href="#cb31-22"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Chi-squared"</span>)</span>
<span id="cb31-23"><a href="#cb31-23"></a></span>
<span id="cb31-24"><a href="#cb31-24"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(p1, p2, p3, p4, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<p><img data-src="W6_ProbabilityR_files/figure-revealjs/unnamed-chunk-20-1.png" width="960"></p>
</div>
</div>
</div>
</section>
<section id="simulate-a-fake-dataset" class="slide level2">
<h2>Simulate a Fake Dataset</h2>
<p>Let’s simulate data of 120 participants of different heights and genders flipping a coin. To do so, we need to know how to simulate a) heights, b) flip a coin, and c) assign genders.</p>
<div class="fragment">
<p>Simulate heights:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>heights <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">120</span>, <span class="at">mean =</span> <span class="dv">170</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p>Simulate coin flips:</p>
<p>(Instead of drawing from a probability distribution function that starts with an r, e.g.&nbsp;<code>rnorm()</code>, we use <code>sample()</code>, which randomly (<em>uniformly</em>) draws from values you determine. We need to set <code>replace=TRUE</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>coin_flips <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Head"</span>, <span class="st">"Tail"</span>), <span class="dv">120</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p>We could of course use similar code to simulate gender or the like.</p>
<p>But if we want to predetermine which genders we want to collect data from (i.e.&nbsp;same number in each gender group), we can also use the function <code>rep()</code>. This function will simply repeat an observation for a number of rows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>genders <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">"man"</span>, <span class="st">"woman"</span>, <span class="st">"nonbinary"</span>), <span class="at">each =</span> <span class="dv">40</span>) <span class="co">#%&gt;% sample() #you can run just "sample" on a vector to randomize its order</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p>Determine participant numbers and combining everything into one dataframe:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>sim_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb35-2"><a href="#cb35-2"></a>  <span class="at">participant_number =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">120</span>,</span>
<span id="cb35-3"><a href="#cb35-3"></a>  <span class="at">gender =</span> <span class="fu">rep</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">"man"</span>, <span class="st">"woman"</span>, <span class="st">"nonbinary"</span>), <span class="at">each =</span> <span class="dv">40</span>),</span>
<span id="cb35-4"><a href="#cb35-4"></a>  <span class="at">height =</span> <span class="fu">rnorm</span>(<span class="dv">120</span>, <span class="at">mean =</span> <span class="dv">170</span>, <span class="at">sd =</span> <span class="dv">10</span>),</span>
<span id="cb35-5"><a href="#cb35-5"></a>  <span class="at">coin_flip =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Head"</span>, <span class="st">"Tail"</span>), <span class="dv">120</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb35-6"><a href="#cb35-6"></a>)</span>
<span id="cb35-7"><a href="#cb35-7"></a></span>
<span id="cb35-8"><a href="#cb35-8"></a><span class="co"># or if you have run all the code before, you could also use the objects you have already in your Environment:</span></span>
<span id="cb35-9"><a href="#cb35-9"></a><span class="co"># sim_data &lt;- tibble(participant_number = 1:120, genders, heights, coin_flips)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<p>Because the values of heights and coin flips are random, the assignment of</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="resampling" class="slide level2">
<h2>Resampling</h2>
<p>If we wanted to do a <strong>Monte Carlo Simulation,</strong> we could use the code from the last slide and put the simulation into a <code>for</code> loop. Inside the <code>for</code> loop, we would also calculate some value of interest (one estimate per subsample, such as the mean).</p>
</section>
<section id="resampling-2" class="slide level2">
<h2>Resampling 2</h2>
<p>But for now, let’s look at the <strong>Bootstrap</strong>. Remember that we usually use real data for bootstrapping and draw samples <em>with replacement</em> of the same size as the original dataset. We can use this to quantify uncertainty, such as with the Standard Error of the Mean (SEM) or Confidence Intervals.</p>
<p>Let’s say we have a very small sample of “sweets consumed”. We don’t know the underlying distribution. We make up a dataset, but let’s pretend it is our real data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>data_10 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb36-2"><a href="#cb36-2"></a>  <span class="at">participant =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb36-3"><a href="#cb36-3"></a>  <span class="at">sweets =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">4</span>)</span>
<span id="cb36-4"><a href="#cb36-4"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>We want to know how sample size influences the SEM, so we also have a sample with <del>twice</del> 10x as many observations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>data_20 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb37-2"><a href="#cb37-2"></a>  <span class="at">participant =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,</span>
<span id="cb37-3"><a href="#cb37-3"></a>  <span class="at">sweets =</span> <span class="fu">rpois</span>(<span class="dv">100</span>,<span class="dv">4</span>) <span class="co">#random Poisson distribution</span></span>
<span id="cb37-4"><a href="#cb37-4"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="resampling-3" class="slide level2">
<h2>Resampling 3</h2>
<p>Let’s resample 1000 times. To get the sampling distributions of the means, we have to save each mean of each iteration:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="fu">set.seed</span>(<span class="dv">8465123</span>)</span>
<span id="cb38-2"><a href="#cb38-2"></a>iterations <span class="ot">&lt;-</span> <span class="dv">1000</span> </span>
<span id="cb38-3"><a href="#cb38-3"></a></span>
<span id="cb38-4"><a href="#cb38-4"></a><span class="co"># initialize empty matrices</span></span>
<span id="cb38-5"><a href="#cb38-5"></a>mean_bootstrap_10 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> iterations, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb38-6"><a href="#cb38-6"></a>mean_bootstrap_20 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> iterations, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb38-7"><a href="#cb38-7"></a></span>
<span id="cb38-8"><a href="#cb38-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>iterations) {</span>
<span id="cb38-9"><a href="#cb38-9"></a>  <span class="co"># draw exactly the same amount of datapoints as in the original dataset, but with replacement</span></span>
<span id="cb38-10"><a href="#cb38-10"></a>  bootstrap_data_10 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(data_10, <span class="dv">10</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb38-11"><a href="#cb38-11"></a>  bootstrap_data_20 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(data_20, <span class="dv">20</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb38-12"><a href="#cb38-12"></a>  </span>
<span id="cb38-13"><a href="#cb38-13"></a>  <span class="co"># calculate the mean for each of the subsamples, put it into matrix in subsequent rows</span></span>
<span id="cb38-14"><a href="#cb38-14"></a>  mean_bootstrap_10[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(bootstrap_data_10<span class="sc">$</span>sweets)</span>
<span id="cb38-15"><a href="#cb38-15"></a>  mean_bootstrap_20[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(bootstrap_data_20<span class="sc">$</span>sweets)</span>
<span id="cb38-16"><a href="#cb38-16"></a>}</span>
<span id="cb38-17"><a href="#cb38-17"></a></span>
<span id="cb38-18"><a href="#cb38-18"></a><span class="co"># calculate the SEMs</span></span>
<span id="cb38-19"><a href="#cb38-19"></a><span class="fu">sd</span>(mean_bootstrap_10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4948013</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="fu">sd</span>(mean_bootstrap_20)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4423667</code></pre>
</div>
</div>
<p>We can conclude that the SEM is smaller with a larger sample size, which means we can be more certain about our estimate! (We already knew this from the <span class="math inline">\(\sqrt{n}\)</span> in the denominator of the SE formular but it’s nice to see it confirmed.)</p>
</section></section>
<section id="thanks" class="title-slide slide level1 center">
<h1>Thanks!</h1>
<p><strong>Learning objectives:</strong></p>
<ul>
<li><p>Understand that there are different types of data that follow different kinds of distributions.</p></li>
<li><p>Be able to use these distributions to calculate the probability of particular outcomes.</p>
<ul>
<li>This will be the foundation of statistical significance testing (testing whether some probability is <span class="math inline">\(\le 5\%\)</span>)!</li>
</ul></li>
</ul>
<p><strong>Next</strong>:</p>
<p>Hypothesis testing! Finally! :D</p>
<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="W6_ProbabilityR_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="W6_ProbabilityR_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="W6_ProbabilityR_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="W6_ProbabilityR_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="W6_ProbabilityR_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="W6_ProbabilityR_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="W6_ProbabilityR_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="W6_ProbabilityR_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="W6_ProbabilityR_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="W6_ProbabilityR_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="W6_ProbabilityR_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>