<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.32">

  <meta name="author" content="Dr.&nbsp;Lea Hildebrandt">
  <title>Biostatistics – 06 Sampling and Resampling/Simulations</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto-816793a8a4a837d14f6ea458e2f1c5cb.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">06 Sampling and Resampling/Simulations</h1>
  <p class="subtitle"></p><div class="line-block">Julius-Maximilians-University Würzburg<br>
Course: “Biostatistics”<br>
Translational Neuroscience</div><p></p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Dr.&nbsp;Lea Hildebrandt 
</div>
</div>
</div>

</section>
<section>
<section id="sampling" class="title-slide slide level1 center">
<h1>Sampling</h1>
<p>We have already mentioned the difference between the whole <strong>population</strong> and our <strong>sample</strong>. To be able to draw inferences from a relatively small sample to a population is one of the core ideas of statistics.</p>
<div class="fragment">
<p>Why do we sample?</p>
<ul>
<li class="fragment"><p>Time: It’s often impossible to measure whole population.</p></li>
<li class="fragment"><p>A subset (sample) might be sufficient to estimate a value of interest (diminishing marginal returns).</p></li>
</ul>
<aside class="notes">
<p>Usually, we can’t measure the whole population. In some cases (e.g.&nbsp;rare diseases) it might in principle be possible. In this case, we usually don’t need (inferential) statistics because we can simply describe the population with descriptive statistics. Inferential stats allow us to estimate values and their uncertainty!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="how-do-we-sample" class="slide level2">
<h2>How Do We Sample?</h2>
<p>The sample needs to be <em>representative</em> of the entire population, that’s why it’s critical how we select the individuals.</p>
<p>Think about examples of <em>non-representative</em> samples!</p>
<div class="fragment">
<p><strong><em>Representative</em></strong>: Every member of the population has an equal chance of being selected.</p>
<p>If non-representative: sample statistic is <em>biased</em>, its value is (systematically) different from the true population value (<em>parameter</em>).<br>
(But talking about bias is mostly a theoretical discussion: Usually we of course don’t know the population parameter and thus cannot compare our estimate with it! Otherwise we wouldn’t need to sample.)</p>
<aside class="notes">
<p><em>Non-representative:</em> pollster calls people from list of Democratic party, or from rich neighborhood, or only uses psychology students :D</p>
<p>Think about “your” sample, how could this be non-representative?</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="different-ways-of-sampling" class="slide level2">
<h2>Different Ways of Sampling</h2>
<ul>
<li><p><strong>without replacement</strong>: Once a member of the population is sampled, they are not eligible to be sampled again. This is the most common variant of sampling.</p></li>
<li><p><strong>with replacement</strong>: After a member of the population has been sampled, they are put back into the pool and could potentially be sampled again. This usually happens out of accident or by necessity (cf.&nbsp;<em>Bootstrapping</em>)</p></li>
</ul>
</section>
<section id="sampling-error" class="slide level2">
<h2>Sampling Error</h2>
<p>It is likely that our sample statistic differs slightly from the population parameter. This is called the <strong>sampling error</strong>.</p>
<p>If we collect multiple samples, the sample statistic will always differ slightly. If we combine all those sample statistics, we can approximate the <strong>sampling distribution</strong>.</p>
<p>Of course, we want to minimize the sampling error and get a good estimate of the population parameter!</p>
</section>
<section id="example-sampling-distribution" class="slide level2">
<h2>Example Sampling Distribution</h2>
<p>Let’s use the NHANES dataset again and let’s assume it is the entire population. We can calculate the mean (<span class="math inline">\(\mu = 168.35\)</span>) and standard deviation (<span class="math inline">\(\sigma = 10.16\)</span>) as the population parameters. If we <em>repeatedly</em> sample 50 individuals, we get this:</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: right;">sampleMean</th>
<th style="text-align: right;">sampleSD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">169.056</td>
<td style="text-align: right;">9.785374</td>
</tr>
<tr class="even">
<td style="text-align: right;">166.598</td>
<td style="text-align: right;">11.198606</td>
</tr>
<tr class="odd">
<td style="text-align: right;">166.862</td>
<td style="text-align: right;">11.626305</td>
</tr>
<tr class="even">
<td style="text-align: right;">166.712</td>
<td style="text-align: right;">11.012750</td>
</tr>
<tr class="odd">
<td style="text-align: right;">168.786</td>
<td style="text-align: right;">10.796447</td>
</tr>
</tbody>
</table>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="W6_Sampling_files/figure-revealjs/unnamed-chunk-2-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
<div class="fragment">
<p>The sample means and SDs are similar, but not exactly equal to the population parameters.</p>
<p>If we sample 5000 times (50 individuals each), we can see that the average of these 5000 sample means (depicted in blue) is similar to the population mean!<br>
Average sample mean across 5000 sample: <span class="math inline">\(\hat{X} = 168.3463\)</span>.</p>
<aside class="notes">
<p>grey = population histogram (raw data) blue = sample means of samples with N=50</p>
<p>What is similar between these distributions? What is different?</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="standard-error-of-the-mean" class="slide level2">
<h2>Standard Error of the Mean</h2>
<p>In the example on the last slide, the means were all pretty close to each other, i.e.&nbsp;the blue distribution was very narrow and the variance small (compared to the grey distribution). This is an <strong>inherent statistical property of sample means</strong>: By averaging several individual values, thus <strong>aggregating</strong> them into a sample (here with <span class="math inline">\(n = 50\)</span>), we <strong>reduce the variability of the sampling distribution</strong>.</p>
<div class="fragment">
<p>We can quantify this variability of the sample mean with the <strong>standard error of the mean (SEM)</strong>.</p>
<p><span class="math display">\[SEM = \frac{\hat{\sigma}}{\sqrt{n}}\]</span></p>
<p>This formula needs two values: the population variability <span class="math inline">\(\sigma\)</span> (or sample SD <span class="math inline">\(\hat{\sigma}\)</span> as approximation) and the size of our sample <span class="math inline">\(n\)</span>.</p>
</div>
<div class="fragment">
<p>We can only control our sample size, thus if we want a better estimate, we can increase sample size!</p>
<p>A sample of <span class="math inline">\(n = 50\)</span> already decreases the population variability by a factor of <span class="math inline">\(\sqrt{50} = 7.1\)</span> !</p>
<aside class="notes">
<p>SEM ~ SD of sampling distribution of the mean</p>
<p>Takes the SD of the data and divides it by sample size (so always smaller than SD!)</p>
<p>We use the sample SD as an approximation for the population SD</p>
<p>Use the sigma of the data? same as sd(sample_means)</p>
<p>“the utility of larger samples diminishes with the square root of the sample size”: Doubling the sample size will not double the quality of the statistic.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="the-central-limit-theorem" class="slide level2">
<h2>The Central Limit Theorem</h2>
<p>The Central Limit Theorem (CLT) is a fundamental (and often misunderstood) concept of statistics.</p>
<p>CLT: With larger sample sizes, the <strong>sampling distribution of sample means</strong> (i.e., the blue distribution from before) will become more and more <strong>normally distributed</strong>*, even if the <em>population distribution</em> is not (i.e., the grey distribution from before)!</p>

<img data-src="images/norm_dist_height.PNG" width="399" class="r-stretch quarto-figure-left"><p class="caption">Normal Distribution of Height</p><div class="fragment">
<p><strong>Note</strong>: Means approximate a normal distribution, irrespective of the distribution from which the data stem. This is because the <strong>sampling error</strong> between the sampling mean <span class="math inline">\(\hat{\mu}\)</span> and the population mean <span class="math inline">\(\mu\)</span> follows a normal distribution.</p>
<aside class="notes">
<p>Described by mean and sd: Shape never changes, only location and width!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="clt-in-action" class="slide level2">
<h2>CLT in Action</h2>
<p>On the left you can see a highly skewed distribution of alcohol consumption per year (from the NHANES dataset). If we repeatedly draw samples of size 50 from the datset and take the mean, we get the right distribution of sample means - which looks a lot more “normal” (normal distribution is added in red)!</p>

<img data-src="W6_Sampling_files/figure-revealjs/unnamed-chunk-3-1.png" width="960" class="r-stretch"><div class="fragment">
<p>The CLT is important because it allows us to safely assume that the sampling distribution <strong>of the mean</strong> will be normal in most cases, which is a necessary prerequisite for many statistical techniques.</p>
<aside class="notes">
<p>Red peak: True population mean Blue values left of peak: Sampling error with underestimation of the true population mean Blue values right of peak: Sampling error with overestimation of the true population mean</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section></section>
<section>
<section id="resampling-and-simulation" class="title-slide slide level1 center">
<h1>Resampling and Simulation</h1>

</section>
<section id="simulations" class="slide level2">
<h2>Simulations</h2>
<p>As you saw in last lecture, we can also use similar functions (usually starting with <code>r</code>) to simulate data (i.e., to draw samples from probability distributions).</p>
<p>This can be helpful if we don’t know the “ground truth” or want to quantify uncertainty. We can also use simulations to calculate the power of a study.</p>
<p>With simulations, we define the expected “ground truth” (distribution of the population) and generate data from it.</p>
<div class="fragment">
<p><strong>Example</strong>: We can use <code>rnorm()</code> to simulate data from a normal distribution with given parameters. Here, we will use means and SDs from the Scottish Health Survey (2008) to visualize two normal distributions:</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a>men <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">100000</span>, <span class="at">mean =</span> <span class="fl">176.2</span>, <span class="at">sd =</span> <span class="fl">6.748</span>) </span>
<span id="cb1-2"><a></a>women <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">100000</span>, <span class="at">mean =</span> <span class="fl">163.8</span>, <span class="at">sd =</span> <span class="fl">6.931</span>)  </span>
<span id="cb1-3"><a></a>heights <span class="ot">&lt;-</span> <span class="fu">tibble</span>(men, women) <span class="sc">%&gt;%</span>   </span>
<span id="cb1-4"><a></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">"sex"</span>, <span class="at">values_to =</span> <span class="st">"height"</span>, men<span class="sc">:</span>women)  </span>
<span id="cb1-5"><a></a>heights <span class="sc">%&gt;%</span> </span>
<span id="cb1-6"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">fill =</span> sex)) <span class="sc">+</span>   </span>
<span id="cb1-7"><a></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> .<span class="dv">6</span>) <span class="sc">+</span>   </span>
<span id="cb1-8"><a></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"E"</span>) <span class="sc">+</span>   </span>
<span id="cb1-9"><a></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="W6_Sampling_files/figure-revealjs/unnamed-chunk-4-1.png" width="960"></p>
</figure>
</div>
</div>
</div></div>
<p>We could use these data to visualize how much overlap there is between the two distributions of men and women, or to test how big the difference in height needs to be to become significant etc.</p>
<p>We use “real data” as input for the simulations! So the simulations are based on empirical values (means, sd), but we actually draw more observations, 100.000!</p>
</div>
</section>
<section id="simulate-different-distributions" class="slide level2">
<h2>Simulate Different Distributions</h2>
<p>It is possible to draw data from different distributions:</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a>nsamples <span class="ot">&lt;-</span> <span class="dv">10000</span> </span>
<span id="cb2-2"><a></a>nhistbins <span class="ot">&lt;-</span> <span class="dv">100</span>  </span>
<span id="cb2-3"><a></a></span>
<span id="cb2-4"><a></a><span class="co"># uniform distribution </span></span>
<span id="cb2-5"><a></a>p1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">runif</span>(nsamples)) <span class="sc">%&gt;%</span>    </span>
<span id="cb2-6"><a></a>  <span class="fu">ggplot</span>((<span class="fu">aes</span>(x))) <span class="sc">+</span> </span>
<span id="cb2-7"><a></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> nhistbins) <span class="sc">+</span>    </span>
<span id="cb2-8"><a></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Uniform"</span>)  </span>
<span id="cb2-9"><a></a></span>
<span id="cb2-10"><a></a><span class="co"># binomial distribution </span></span>
<span id="cb2-11"><a></a>p2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rbinom</span>(nsamples, <span class="dv">20</span>, <span class="fl">0.25</span>)) <span class="sc">%&gt;%</span>    </span>
<span id="cb2-12"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x)) <span class="sc">+</span> </span>
<span id="cb2-13"><a></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> nhistbins) <span class="sc">+</span>   </span>
<span id="cb2-14"><a></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Binomial (p=0.25, 20 trials)"</span>)  </span>
<span id="cb2-15"><a></a></span>
<span id="cb2-16"><a></a><span class="co"># normal distribution </span></span>
<span id="cb2-17"><a></a>p3 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(nsamples)) <span class="sc">%&gt;%</span>    </span>
<span id="cb2-18"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x)) <span class="sc">+</span> </span>
<span id="cb2-19"><a></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> nhistbins) <span class="sc">+</span>   </span>
<span id="cb2-20"><a></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Normal"</span>)  </span>
<span id="cb2-21"><a></a></span>
<span id="cb2-22"><a></a><span class="co"># Chi-squared distribution </span></span>
<span id="cb2-23"><a></a>p4 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rchisq</span>(nsamples, <span class="at">df=</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span>    </span>
<span id="cb2-24"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x)) <span class="sc">+</span> </span>
<span id="cb2-25"><a></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> nhistbins) <span class="sc">+</span>   </span>
<span id="cb2-26"><a></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Chi-squared"</span>)  </span>
<span id="cb2-27"><a></a></span>
<span id="cb2-28"><a></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(p1, p2, p3, p4, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="W6_Sampling_files/figure-revealjs/unnamed-chunk-5-1.png" width="960"></p>
</figure>
</div>
</div>
</div></div>
</section>
<section id="simulate-a-fake-dataset" class="slide level2">
<h2>Simulate a Fake Dataset</h2>
<p>Let’s simulate data of 120 participants of different heights and genders flipping a coin. To do so, we need to know how to simulate a) heights, b) flip a coin, and c) assign genders.</p>
<div class="fragment">
<p>Simulate heights:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a>heights <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">120</span>, <span class="at">mean =</span> <span class="dv">170</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p>Simulate coin flips:</p>
<p>(Instead of drawing from a probability distribution function that starts with an r, e.g.&nbsp;<code>rnorm()</code>, we use <code>sample()</code>, which randomly (<em>uniformly</em>) draws from values you determine. We need to set <code>replace=TRUE</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a>coin_flips <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Head"</span>, <span class="st">"Tail"</span>), <span class="dv">120</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p>We could of course use similar code to simulate gender or the like.</p>
<p>But if we want to predetermine which genders we want to collect data from (i.e.&nbsp;same number in each gender group), we can also use the function <code>rep()</code>. This function will simply repeat an observation for a number of rows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a>genders <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">"man"</span>, <span class="st">"woman"</span>, <span class="st">"nonbinary"</span>), <span class="at">each =</span> <span class="dv">40</span>) <span class="co">#%&gt;% sample() </span></span>
<span id="cb5-2"><a></a><span class="co">#you can run just "sample" on a vector to randomize its order </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p>Determine participant numbers and combining everything into one dataframe:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a>sim_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(   </span>
<span id="cb6-2"><a></a>  <span class="at">participant_number =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">120</span>,   </span>
<span id="cb6-3"><a></a>  <span class="at">gender =</span> <span class="fu">rep</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">"man"</span>, <span class="st">"woman"</span>, <span class="st">"nonbinary"</span>), <span class="at">each =</span> <span class="dv">40</span>),   </span>
<span id="cb6-4"><a></a>  <span class="at">height =</span> <span class="fu">rnorm</span>(<span class="dv">120</span>, <span class="at">mean =</span> <span class="dv">170</span>, <span class="at">sd =</span> <span class="dv">10</span>),   </span>
<span id="cb6-5"><a></a>  <span class="at">coin_flip =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Head"</span>, <span class="st">"Tail"</span>), <span class="dv">120</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) )  </span>
<span id="cb6-6"><a></a></span>
<span id="cb6-7"><a></a><span class="co"># or if you have run all the code before, you could also use the objects you have already in your Environment: </span></span>
<span id="cb6-8"><a></a><span class="co"># sim_data &lt;- tibble(participant_number = 1:120, genders, heights, coin_flips)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If we wanted to do a <strong>Monte Carlo Simulation,</strong> we could use the code from the last slide and put the simulation into a <code>for</code> loop. Inside the <code>for</code> loop, we would also calculate some value of interest (one estimate per subsample, such as the mean).</p>
</div>
</section>
<section id="monte-carlo-simulation" class="slide level2 scrollable">
<h2>Monte Carlo Simulation</h2>
<p>With the increasing use of computers, simulations have become an essential part of modern statistics. Monte Carlo simulations are the most common ones in statistics.</p>
<p>There are four steps to performing a Monte Carlo simulation:</p>
<ol type="1">
<li><p>Define a <strong>domain of possible values</strong>.</p></li>
<li><p><strong>Generate random numbers</strong> within that domain from a probability distribution.</p></li>
<li><p>Perform a <strong>computation</strong> using the random numbers.</p></li>
<li><p>Combine the results across <strong>many repetitions</strong>.</p></li>
</ol>
</section>
<section id="randomness-in-statistics" class="slide level2">
<h2>Randomness in Statistics</h2>
<p><strong>Random</strong> = unpredictable.</p>
<p>For a Monte Carlo simulation, we need <strong>pseudo-random* numbers</strong>, which are generated by a computer algorithm.</p>
<div class="fragment">
<p>We can simply generate (pseudo-)random numbers from different distributions with R, e.g.&nbsp;with <code>rnorm()</code> to draw (pseudo-)random numbers from a normal distribution:</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a><span class="co"># Draw 10000 random numbers of a normal distribution with mean=0, sd=1</span></span>
<span id="cb7-2"><a></a>rand_num <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb7-3"><a></a></span>
<span id="cb7-4"><a></a><span class="co"># Plot the random numbers and verify that they make up a normal distribution</span></span>
<span id="cb7-5"><a></a><span class="fu">tibble</span>(<span class="at">x =</span> rand_num) <span class="sc">%&gt;%</span> </span>
<span id="cb7-6"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb7-7"><a></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb7-8"><a></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Normal"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="W6_Sampling_files/figure-revealjs/unnamed-chunk-10-1.png" width="960"></p>
</figure>
</div>
</div>
</div></div>
</div>
<div class="fragment">
<p>Each time, we generate random numbers, these will differ slightly.</p>
<p>But we can also generate the exact same set of random numbers (which will be helpful to reproduce results!) by setting the random seed to a specific value such as 123: <code>set.seed(123)</code>.</p>

<aside class="notes">
<p><code>rnorm()</code>: Here, r stands for random normal distribution</p>
<p>Flip a coin, we don’t know the outcome! (Only if we knew a lot of physics and the conditions…)</p>
<p>Humans have a bad sense of randomness, we think we see patterns everywhere (gambler’s fallacy: being due for a win).</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
<aside><div>
<p>* <em>Truly random</em> numbers, that are completely unpredictable, are only possible through physical processes that are difficult to obtain.</p>
<p><em>Pseudo-random</em> numbers will only seem random (they are difficult to predict) but will repeat at some point.</p>
</div></aside></section>
<section id="using-monte-carlo-simulations" class="slide level2">
<h2>Using Monte Carlo Simulations</h2>
<p>Example: Let’s try to find out how much time we should allow for a short in-class quiz.</p>
<p>We pretend to know the distribution of completion times is normal, with mean = 5 min and SD = 1 min.</p>
<p><strong>How long does the test period need to be so that we can expect ALL students (n = 150) to finish in 99% of the quizzes?</strong></p>
<div class="fragment">
<p>To answer this question, we need the distribution of the <em>longest</em> finishing time.</p>
<p>What we will do is to simulate finishing times for a great number of quizzes and take the maximum of each (the longest finishing time). We can then look at the distribution of maximum finishing times and see where the 99% quantile is.<br>
This value is the amount of time that we should allow - <em>given our assumptions</em>!!</p>
</div>
</section>
<section id="using-monte-carlo-simulations-2" class="slide level2 scrollable">
<h2>Using Monte Carlo Simulations 2</h2>
<p>Let’s repeat the steps of the simulation by going through the four steps mentioned before:</p>
<ol type="1">
<li>Define a <strong>domain of possible values</strong>.</li>
</ol>
<p>–&gt; Our assumptions: The values would come from a normal distribution with <span class="math inline">\(n = 150\)</span>, <span class="math inline">\(mean = 5\)</span>, and <span class="math inline">\(SD = 1\)</span>.</p>
<div class="fragment">
<ol start="2" type="1">
<li><strong>Generate random numbers</strong> within that domain from a probability distribution.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a>rand_num <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">150</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<ol start="3" type="1">
<li>Perform a <strong>computation</strong> using the random numbers.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a>max_rand_num <span class="ot">&lt;-</span> <span class="fu">max</span>(rand_num) <span class="co">#time of slowest student</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="using-monte-carlo-simulations-3" class="slide level2 scrollable">
<h2>Using Monte Carlo Simulations 3</h2>
<ol start="4" type="1">
<li>Combine the results across <strong>many repetitions</strong>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a>nrep <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#number of repetitions</span></span>
<span id="cb10-2"><a></a></span>
<span id="cb10-3"><a></a><span class="co"># initialize an empty matrix to fill in the max values later</span></span>
<span id="cb10-4"><a></a>max_rand_num <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">nrow =</span> nrep, <span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb10-5"><a></a></span>
<span id="cb10-6"><a></a><span class="co"># use a for-loop to repeat resampling nrep times!</span></span>
<span id="cb10-7"><a></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nrep) {</span>
<span id="cb10-8"><a></a>  rand_num <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">150</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb10-9"><a></a>  max_rand_num[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">max</span>(rand_num)</span>
<span id="cb10-10"><a></a>}</span>
<span id="cb10-11"><a></a></span>
<span id="cb10-12"><a></a><span class="co"># get the cutoff (99%) of the distribution of max values</span></span>
<span id="cb10-13"><a></a>cutoff <span class="ot">&lt;-</span> <span class="fu">quantile</span>(max_rand_num, <span class="fl">0.99</span>)</span>
<span id="cb10-14"><a></a><span class="fu">print</span>(cutoff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     99% 
8.866392 </code></pre>
</div>
</div>
</section>
<section id="using-monte-carlo-simulations-4" class="slide level2">
<h2>Using Monte Carlo Simulations 4</h2>

<img data-src="W6_Sampling_files/figure-revealjs/unnamed-chunk-14-1.png" width="960" class="r-stretch"><p>This shows that the 99th percentile of the finishing time distribution falls at 8.768088 minutes, meaning that if we were to give that much time for the quiz, then we expect that in 99% of quizzes, every student would finish.</p>
<aside class="notes">
<p>Assumptions matter, otherwise results wrong! (We assumed: normal dist w/ particular mean and SD). Here assumptions certainly wrong –&gt; elapsed time not normal</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="resampling-the-bootstrap" class="slide level2 scrollable">
<h2>Resampling: The Bootstrap</h2>
<p>We can use simulations to demonstrate statistical principles (like we just did) but also to answer statistical questions.</p>
<p>The <strong>bootstrap</strong> is a simulation technique that allows us to quantify our <em>uncertainty</em> of estimates!</p>
<div class="fragment">
<ol type="1">
<li>We repeatedly sample <em>with replacement</em> from an actual dataset.</li>
<li>We compute a statistic of interest for each sample.</li>
<li>We get the distribution of those statistics and use it as our sampling distribution.</li>
</ol>
</div>
</section>
<section id="bootstrap-example" class="slide level2">
<h2>Bootstrap Example</h2>
<p>Let’s use the bootstrap to estimate the sampling distribution of the mean heights of the NHANES dataset. We can then compare the result to the SEM (=uncertainty of the mean) that we discussed earlier.</p>
<div class="columns">
<div class="colum">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a></a><span class="co"># perform the bootstrap to compute SEM and compare to parametric method</span></span>
<span id="cb12-2"><a></a>nRuns <span class="ot">&lt;-</span> <span class="dv">2500</span></span>
<span id="cb12-3"><a></a>sampleSize <span class="ot">&lt;-</span> <span class="dv">32</span></span>
<span id="cb12-4"><a></a></span>
<span id="cb12-5"><a></a>heightSample <span class="ot">&lt;-</span> </span>
<span id="cb12-6"><a></a>  NHANES_adult <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a></a>  <span class="fu">sample_n</span>(sampleSize) <span class="co"># draw 32 observations</span></span>
<span id="cb12-8"><a></a></span>
<span id="cb12-9"><a></a><span class="co"># function to bootstrap (sample w/ replacement) &amp; get mean</span></span>
<span id="cb12-10"><a></a>bootMeanHeight <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb12-11"><a></a>  bootSample <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(df, <span class="fu">dim</span>(df)[<span class="dv">1</span>], <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-12"><a></a>  <span class="fu">return</span>(<span class="fu">mean</span>(bootSample<span class="sc">$</span>Height))</span>
<span id="cb12-13"><a></a>}</span>
<span id="cb12-14"><a></a></span>
<span id="cb12-15"><a></a><span class="co"># run function 2500x</span></span>
<span id="cb12-16"><a></a>bootMeans <span class="ot">&lt;-</span> <span class="fu">replicate</span>(nRuns, <span class="fu">bootMeanHeight</span>(heightSample))</span>
<span id="cb12-17"><a></a></span>
<span id="cb12-18"><a></a><span class="co"># calculate "normal" SEM and bootstrap SEM</span></span>
<span id="cb12-19"><a></a>SEM_standard <span class="ot">&lt;-</span> <span class="fu">sd</span>(heightSample<span class="sc">$</span>Height) <span class="sc">/</span> <span class="fu">sqrt</span>(sampleSize)</span>
<span id="cb12-20"><a></a>SEM_bootstrap <span class="ot">&lt;-</span> <span class="fu">sd</span>(bootMeans)</span>
<span id="cb12-21"><a></a></span>
<span id="cb12-22"><a></a>SEM_standard</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.564454</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a></a>SEM_bootstrap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.542479</code></pre>
</div>
</div>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="W6_Sampling_files/figure-revealjs/bootstrapSEM-1.png" style="height:50.0%" width="384"></p>
<figcaption>An example of bootstrapping to compute the standard error of the mean adult height in the NHANES dataset. The histogram shows the distribution of means across bootstrap samples, while the red line shows the normal distribution based on the sample mean and standard deviation.</figcaption>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="evaluation-bootstrapping" class="slide level2">
<h2>Evaluation: Bootstrapping</h2>
<div class="columns">
<div class="column">
<p><strong>Con</strong><br>
Takes very long to compute (compared to the SEM)<br>
Precision depends on computing time</p>
</div><div class="column">
<p><strong>Pro</strong><br>
No assumption about sampling distribution necessary<br>
Is a good solution if you do not want to rely on certain assumptions</p>
</div></div>
<div class="fragment">
<p>Bootstrapping is a so-called <strong>model-free</strong> procedure: You put in just the data and get a result that does not depend on any further assumptions.<br>
Model-based procedures (like most statistical tests we will cover in this class) are usually more precise <em>if their assumptions are met</em>. Unfortunately, assumptions are not always straightforward to check.</p>
</div>
</section>
<section id="resampling" class="slide level2">
<h2>Resampling</h2>
<p>Let’s look at the <strong>Bootstrap</strong>. Remember that we usually use real data for bootstrapping and draw samples <em>with replacement</em> of the same size as the original dataset. We can use this to quantify uncertainty, such as with the Standard Error of the Mean (SEM) or Confidence Intervals.</p>
<p>Let’s say we have a very small sample of “sweets consumed”. We don’t know the underlying distribution. We make up a dataset, but let’s pretend it is our real data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a></a>data_10 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb16-2"><a></a>  <span class="at">participant =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb16-3"><a></a>  <span class="at">sweets =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">4</span>)</span>
<span id="cb16-4"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>We want to know how sample size influences the SEM, so we also have a sample with <del>twice</del> 10x as many observations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a></a>data_20 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb17-2"><a></a>  <span class="at">participant =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,</span>
<span id="cb17-3"><a></a>  <span class="at">sweets =</span> <span class="fu">rpois</span>(<span class="dv">100</span>,<span class="dv">4</span>) <span class="co">#random Poisson distribution</span></span>
<span id="cb17-4"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="resampling-3" class="slide level2">
<h2>Resampling 3</h2>
<p>Let’s resample 1000 times. To get the sampling distributions of the means, we have to save each mean of each iteration:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a></a><span class="fu">set.seed</span>(<span class="dv">8465123</span>)</span>
<span id="cb18-2"><a></a>iterations <span class="ot">&lt;-</span> <span class="dv">1000</span> </span>
<span id="cb18-3"><a></a></span>
<span id="cb18-4"><a></a><span class="co"># initialize empty matrices</span></span>
<span id="cb18-5"><a></a>mean_bootstrap_10 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> iterations, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb18-6"><a></a>mean_bootstrap_20 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> iterations, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb18-7"><a></a></span>
<span id="cb18-8"><a></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>iterations) {</span>
<span id="cb18-9"><a></a>  <span class="co"># draw exactly the same amount of datapoints as in the original dataset, but with replacement</span></span>
<span id="cb18-10"><a></a>  bootstrap_data_10 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(data_10, <span class="dv">10</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb18-11"><a></a>  bootstrap_data_20 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(data_20, <span class="dv">20</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb18-12"><a></a>  </span>
<span id="cb18-13"><a></a>  <span class="co"># calculate the mean for each of the subsamples, put it into matrix in subsequent rows</span></span>
<span id="cb18-14"><a></a>  mean_bootstrap_10[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(bootstrap_data_10<span class="sc">$</span>sweets)</span>
<span id="cb18-15"><a></a>  mean_bootstrap_20[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(bootstrap_data_20<span class="sc">$</span>sweets)</span>
<span id="cb18-16"><a></a>}</span>
<span id="cb18-17"><a></a></span>
<span id="cb18-18"><a></a><span class="co"># calculate the SEMs</span></span>
<span id="cb18-19"><a></a><span class="fu">sd</span>(mean_bootstrap_10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4948013</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a></a><span class="fu">sd</span>(mean_bootstrap_20)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4437247</code></pre>
</div>
</div>
<p>We can conclude that the SEM is smaller with a larger sample size, which means we can be more certain about our estimate! (We already knew this from the <span class="math inline">\(\sqrt{n}\)</span> in the denominator of the SE formular but it’s nice to see it confirmed.)</p>
</section></section>
<section id="thanks" class="title-slide slide level1 center">
<h1>Thanks!</h1>
<p><strong>Learning objectives:</strong></p>
<ul>
<li><p>Understand why we are sampling from a population and what the sampling distribution (and the sampling error) is.</p></li>
<li><p>Understand Monte Carlo Simulations and the Bootstrap, and being able to implement those in R.</p></li>
</ul>
<p><strong>Next</strong>:</p>
<p>Hypothesis testing! Finally! :D</p>


</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,

        height: 720,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/Hillea\.github\.io\/biostats\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>