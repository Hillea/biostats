<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.32">

  <meta name="author" content="Dr.&nbsp;Lea Hildebrandt">
  <title>Biostatistics – 05 Probability</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto-816793a8a4a837d14f6ea458e2f1c5cb.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">05 Probability</h1>
  <p class="subtitle"></p><div class="line-block">Julius-Maximilians-University Würzburg<br>
Course: “Biostatistics”<br>
Translational Neuroscience</div><p></p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Dr.&nbsp;Lea Hildebrandt 
</div>
</div>
</div>

</section>
<section>
<section id="probability" class="title-slide slide level1 center">
<h1>Probability</h1>
<div class="cell">
<style type="text/css">
code.sourceCode {
  font-size: 1.4em;
}

div.cell-output-stdout {
  font-size: 1.4em;
}
</style>
</div>
<p>Probability theory: Branch of mathematics that deals with chance and uncertainty.</p>
<div class="fragment">
<p>So far, we have summarized samples of data, but how do we draw inferences about the population?</p>
<p>–&gt; to draw inferences (i.e., get reasonable estimates for the population), we need probability theory!</p>
</div>
<div class="fragment">
<p>Probability = likelihood of some event (range from 0 = impossible to 1 = certain)</p>
<aside class="notes">
<p>Sampling = next week</p>
<p>Is the mean of a sample equal to the mean of a population?</p>
<p>Probability = backbone of statistics, that’s why we cover it here as well!</p>
<p>(can be translated to percentages: * 100)</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="probability-theory" class="slide level2">
<h2>Probability Theory</h2>
<p>Definitions:</p>
<ul>
<li><p><strong>Experiment</strong>: Activity that produces outcome</p></li>
<li><p><strong>Sample space</strong>: Set of possible outcomes for an experiment</p></li>
<li><p><strong>Event</strong>: Subset of the sample space, an outcome</p></li>
</ul>
<div class="fragment">
<ul>
<li><p><strong>Experiment</strong>: e.g.&nbsp;roll a die</p></li>
<li><p><strong>Sample space</strong>: six-sided die: {1,2,3,4,5,6}</p></li>
<li><p><strong>Event</strong>: e.g.&nbsp;3</p></li>
</ul>
<aside class="notes">
<p>Hand out dice, coins etc to pairs.</p>
<p>Ask what Experiment, Sample Space and Event is in each case.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="probability-theory-2" class="slide level2 scrollable">
<h2>Probability Theory 2</h2>
<p>Let’s say we have a variable <span class="math inline">\(X\)</span> that contains <span class="math inline">\(N\)</span> independent events:</p>
<p><span class="math display">\[
X = E_1, E_2, …, E_n
\]</span></p>
<p>The probability of a certain event (event <span class="math inline">\(i\)</span>) is then formally written as:</p>
<p><span class="math display">\[
P(X = E_i) \]</span></p>
<div class="fragment">
<p>Formal features of probability theory:</p>
<ol type="1">
<li class="fragment"><p>Probability can’t be negative.</p></li>
<li class="fragment"><p>The total probability of outcomes in the sample space is 1.</p></li>
<li class="fragment"><p>The probability of any individual event can’t be greater than 1.</p></li>
</ol>
<aside class="notes">
<p>What is N and E’s in dice/coins case?</p>
<p>Do the 3 features make sense in their own example? Height e.g.&nbsp;is difficult</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="determine-probabilities" class="slide level2">
<h2>Determine Probabilities</h2>
<p>How would you determine probabilities? E.g. how likely is it that you roll a 6 or toss head? (Think about your own example!)</p>
<div class="fragment">
<ul>
<li class="fragment"><p>Personal belief (not very scientific!)</p></li>
<li class="fragment"><p>Empirical frequency</p>
<ul>
<li class="fragment">Law of large numbers</li>
</ul></li>
<li class="fragment"><p>Classical probability</p></li>
</ul>
<aside class="notes">
<p>personal belief: What would have been? Which vaccination is best (opinion)</p>
<p>empirical: count events from the past, divide by possible events (rain days from all days)<br>
–&gt; which year(s)? The more data, the better</p>
<p>Law of large numbers: The more times you repeat an experiment, the less likely you get extreme values.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="classical-probability" class="slide level2 scrollable">
<h2>Classical Probability</h2>
<p><strong>Rules of probability</strong></p>
<ol type="1">
<li class="fragment">What is the probability of an event <em>not</em> happening? (E.g. not rolling a 6)
<ol type="1">
<li class="fragment"><em>Subtraction</em>: Probability of some event (A) not happening = 1- probability that it happens:
<ul>
<li class="fragment"><span class="math inline">\(P(\neg A) = 1 - P(A)\)</span></li>
</ul></li>
</ol></li>
<li class="fragment">What is the probability of two events happening together, i.e.&nbsp;rolling a 3 and a 4 or tossing two heads?
<ol type="1">
<li class="fragment"><em>Intersection</em>: The probability of a conjoint event/that <u>both</u> A and B will occur (<span class="math inline">\(\cap\)</span>):
<ul>
<li class="fragment"><span class="math inline">\(P(A \cap B) = P(A) * P(B)\)</span> (if A and B are <em>independent</em>!)</li>
</ul></li>
</ol></li>
<li class="fragment">What is the probability of <em>either</em> of two events occuring, e.g.&nbsp;rolling a 3 or a 4?
<ol type="1">
<li class="fragment"><em>Addition</em>: Probability of <u>either</u> of two events occurring (<span class="math inline">\(\cup\)</span>):
<ul>
<li class="fragment"><p><span class="math inline">\(P(A \cup B) = P(A) + P(B) - P(A \cap B)\)</span></p></li>
<li class="fragment"><p>We add both but subtract the intersection, prevents us from counting intersection twice!</p></li>
</ul></li>
</ol></li>
</ol>
<aside class="notes">
<p>Ask for every point how they would try to figure it out with dice/coins</p>
<p><span class="math inline">\(\neg A\)</span> = “not A”, derives from Axioms above: Sum must be 1</p>
<p><span class="math inline">\(\cap\)</span> = or; <span class="math inline">\(\cup\)</span> = and</p>
<p>addition: difference 1 vs.&nbsp;2 dice!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="classical-probability-2" class="slide level2">
<h2>Classical Probability 2</h2>
<p>Probability of getting at least one 6 within two dice rolls: 11x success out of 36 possibilities: <span class="math inline">\(\frac{11}{36} = 30.1\%\)</span></p>

<img data-src="images/ThrowMatrix-1.png" class="r-stretch quarto-figure-center"><p class="caption">Each cell in this matrix represents an outcome of throws of two dice (rows = one die, columns = other die). Cells in red represent the cells with a six.</p><aside class="notes">
<p>Don’t count 6,6 twice!</p>
<p>For example, go to book</p>
<p>Probability is important for statistics, so it is necessary to go through the rules once</p>
<p>–&gt; necessary to draw inferences from data! How representative are data for population?</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="conditional-probability" class="slide level2">
<h2>Conditional Probability</h2>
<p>How likely is an event given that another event has occurred?</p>
<p><span class="math display">\[P(A|B) = \frac{P(A \cap B)}{P(B)}\]</span></p>
<p>“The conditional probability of A given B is the joint probability divided by the overall probability of B”.</p>
<div class="fragment">
<p>Example: The conditional probability of being infected with Covid-19, given a positive test result (it could be a false positive!). This will be illustrated in more detail in conjunction with <em>Bayes’ Rule</em>.</p>
<aside class="notes">
<p>How likely to roll a 6 if previously a 5? NO, independent events!</p>
<p>How likely is it that you pass the class if you have taken the course?</p>
<p>Probability that both things are true given that the one being conditioned upon is true</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="independence" class="slide level2">
<h2>Independence</h2>
<p>Starting point: <span class="math display">\[P(A|B) = \frac{P(A \cap B)}{P(B)}\]</span> For independence: <span class="math display">\[ P(A \cap B) = P(A) * P(B) \]</span> This means: <span class="math display">\[P(A|B) = \frac{P(A)*P(B)}{P(B)} = P(A)\]</span></p>
<p>=&gt; Independence = Knowing the value of one variable doesn’t tell us anything about the value of the other</p>
<p>But if the two variables are dependent, the conditional probability <span class="math inline">\(P(A|B)\)</span> will differ from the overall probability <span class="math inline">\(P(A)\)</span>.</p>
<aside class="notes">
<p>Comparing conditional and overall prob might be helpful to determine whether variables are independent.</p>
<p>Ex: physical activity and mental health.</p>
<p>Use conditional probability in most cases!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="exercises" class="slide level2 scrollable">
<h2>Exercises</h2>
<ol type="1">
<li>There have been 10 parties so far. Anna has gone to 5 of them, Barbara to 8. How likely do you expect each Anna and Barbara to go to the next party?</li>
</ol>
<div class="fragment">
<p><span class="math display">\[ P(A) = \frac{5}{10} = 50\%; P(B) = \frac{8}{10} = 80\% \]</span></p>
</div>
<div class="fragment">
<ol start="2" type="1">
<li>Out of the 10 parties, to how many have both Anna and Barbara been under the <em>assumption</em> that they went to parties <em>independently</em>? (Or how likely is it that both Anna and Barbara will go to the next party?)</li>
</ol>
</div>
<div class="fragment">
<p><span class="math display">\[ P(A \cap B) = P(A) * P(B) = .5 * .8 = 40\% \]</span></p>
</div>
<div class="fragment">
<ol start="3" type="1">
<li>You learn that, in fact, Anna and Barbara have both been present at 5 parties. From this information, would you expect that Anna and Barbara are a) friends, b) don’t like each other, c) neither?</li>
</ol>
</div>
<div class="fragment">
<p>Anna and Barbara have both been present at 5 parties but should have been only at 4 given independence. Thus, they were there together more often than “by chance”, indicating that they may have arranged to go together. Hence, they may be friends. (If this increment from 4 to 5 parties is also <em>statistically</em> significant will be answered in the upcoming lectures.)</p>
</div>
<div class="fragment">
<ol start="4" type="1">
<li>You are late to the 11th party - everyone else is already there. You enter the apartment and see Barbara. How likely do you think Anna will also be there?</li>
</ol>
</div>
<div class="fragment">
<p><span class="math display">\[ P(A|B) = \frac{P(A \cap B)}{P(B)} = \frac{50\%}{80\%} = 62.5\% \]</span> 62.5% is not huge but bigger than the prior probability to find Anna at a party of <span class="math inline">\(P(A) = 50\%\)</span>!</p>
</div>
<div class="fragment">
<ol start="5" type="1">
<li>You are late to the 11th party - everyone else is already there. You enter the apartment and see Anna. How likely do you think Barbara will also be there?</li>
</ol>
</div>
<div class="fragment">
<p><span class="math display">\[ P(B|A) = \frac{P(A \cap B)}{P(A)} = \frac{50\%}{50\%} = 100\% \]</span> We have never seen Anna at a party without Barbara (both <span class="math inline">\(P(A)\)</span> and <span class="math inline">\(P(A \cap B)\)</span> are 50%). Thus, we are pretty sure to find Barbara once we see Anna (unless the pattern changes).</p>
<aside class="notes">
<ol start="3" type="1">
<li>Imagine Anna and Barbara hate each other such they would never (or very unlikely) go to the same party. Then, <span class="math inline">\(P(A \cap B) &lt; P(A) * P(B)\)</span>. If they like each other, <span class="math inline">\(P(A \cap B) &gt; P(A) * P(B)\)</span>.</li>
</ol>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="bayes-rule" class="slide level2">
<h2>Bayes’ Rule</h2>
<p>Often we know <span class="math inline">\(P(B|A)\)</span> but really want to know <span class="math inline">\(P(A|B)\)</span>!</p>
<p>Example: From the test manual, we know the probability of getting a positive Covid test when we actually have Covid, <span class="math inline">\(P(positive|Covid)\)</span>. But we usually want to know the probability of having Covid once we tested positive, <span class="math inline">\(P(Covid|positive)\)</span>.</p>
<div class="fragment">
<p>This reversed conditional probability can be calculated using Bayes’ Rule:</p>
<p><span class="math display">\[P(A|B) = \frac{P(A) * P(B|A)}{P(B)}\]</span><br>
</p>
</div>
<div class="fragment">
<p>If we have two outcomes, we can expand using:</p>
<p><span class="math display">\[P(B) = P(A \cap B) + P(\neg A \cap B) = P(A) * P(B|A) + P(\neg A) * P(B|\neg A)\]</span></p>
<p>Updated Bayes’ Rule:</p>
<p><span class="math display">\[P(A|B) = \frac{P(A)*P(B|A)}{P(A)*P(B|A) + P(\neg A)*P(B|\neg A)}\]</span></p>
</div>
</section>
<section id="bayes-rule-2" class="slide level2">
<h2>Bayes’ Rule 2</h2>
<p>Example: Let’s try to find out:</p>
<p><span class="math display">\[P(Covid|positive) = \frac{P(Covid) * P(positive|Covid)}{P(positive)}\]</span></p>
<p>Tests can’t be 100% correct, there are always false positives and false negatives. But let’s say the <em>sensitivity</em> of the test <span class="math inline">\(P(positive|Covid)\)</span> is 95% and the <em>specificity</em> <span class="math inline">\(P(negative|healthy)\)</span> is 75%.</p>
<div class="fragment">
<p>We’d also need the prevalence of Covid, <span class="math inline">\(P(Covid)\)</span>, which is (let’s say) 10%.</p>
<p>Finally, we plug in <span class="math inline">\(P(pos) = P(Covid) * P(pos|Covid) + P(healthy) * P(pos|healthy)\)</span>. So that would be</p>
<p><span class="math display">\[P(positive) = .1 * .95 * + (1-.1) * (1-.95) = .14\]</span></p>
<p>Bringing it together, we get:</p>
<p><span class="math display">\[P(Covid|positive) = \frac{.1 * .95}{.14} = .679\]</span></p>
<p>If we test positive, we’d thus are actually infected with a probability of 67.9%!</p>
</div>
<div class="fragment">
<p>(But before, we only had 10%, i.e.&nbsp;<span class="math inline">\(P(Covid)\)</span>)</p>
</div>
</section>
<section id="learning-from-data" class="slide level2">
<h2>Learning from Data</h2>
<p>The terms in Bayes’ Rule have some specific names:</p>
<p><span class="math display">\[P(Covid|positive) = \frac{P(Covid) * P(positive|Covid)}{P(positive)}\]</span></p>
<div class="fragment">
<p>The prevalence <span class="math inline">\(P(Covid)\)</span> in our example is also called the <em>prior probability</em> (before we have any further information, e.g.&nbsp;the test result).</p>
<p>After we collected new evidence (= test result), we have the <em>likelihood</em>: <span class="math inline">\(P(positive|Covid)\)</span>, which is the sensitivity of the test.</p>
<p><span class="math inline">\(P(positive)\)</span> is the <em>marginal likelihood</em> (overall likelihood positive tests across infected and healthy individuals).</p>
<p>Finally, <span class="math inline">\(P(Covid|test)\)</span> is the <em>posterior probability</em> (after accounting for the new observation).</p>
<aside class="notes">
<p><span class="math display">\[
P(B|A) = \frac{P(A|B)}{P(A)} * P(B)
\]</span></p>
<p><span class="math inline">\(P(A|B)/P(A)\)</span> = how likely the data are given B relative to overall marginal likelihood (how likely a pos rest if Covid relative to how likely it is to have a pos. test in general)</p>
<p><span class="math inline">\(P(B)\)</span> = how likely we thought it was to have Covid before we knew the test result</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="sum-up" class="slide level2">
<h2>Sum Up</h2>
<p>Models and probability are central to statistics, as we will see.</p>
<p>There are two intepretations of probability: <strong>Frequentist</strong> and <strong>Bayesian</strong>.<br>
Frequentists interpret probability as the long-run frequencies (e.g.&nbsp;how many people end up getting Covid).</p>
<p>Bayesians interpret probability as a degree of belief. How likely is it to catch Covid if you go out now? Based on beliefs and knowledge.</p>
<aside class="notes">
<p>Freq: Difficult to wrap ones’ head around if an event occurs only once.</p>
<p>Bayes: Bit more subjective</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="probability-distributions" class="title-slide slide level1 center">
<h1>Probability Distributions</h1>
<p>We already covered classic probability theory, including conditional probability.</p>
<p>Today, we will go more into depth about different <strong>probability distributions</strong>.</p>
<div class="fragment">
<p><strong>Probability distribution</strong> = probability of all possible outcomes in an experiment.</p>
</div>
<div class="fragment">
<p>Helps us answer questions like: How likely is it that event X occurs/we find specific value of X? (<span class="math inline">\(P(X = x_i)\)</span>)</p>
</div>
<div class="fragment">
<p><strong>Cumulative Probability Distribution</strong></p>
<p>–&gt; how likely is it to find a value that is as extreme or larger (or as small or smaller!)? (<span class="math inline">\(P(X \geq x_i)\)</span>)</p>
</div>
<div class="fragment">
<p>A probability distribution is similar to a frequency distribution: The difference is that the <strong>probability distribution</strong> reflects the <em>theory</em> and the <strong>frequency distribution</strong> the <em>observed data</em> (i.e., frequencies are used to <em>approximate</em> probabilities)</p>
</div>
<div class="fragment">
<p><strong>Simulations</strong> can be used to get (an approximation of) a probability distribution!<br>
We don’t have to conduct an experiment, e.g., tossing a coin 100x, but can rather simulate it using R!</p>
<div class="cell">
<style type="text/css">
code.sourceCode {
  font-size: 1.4em;
}

div.cell-output-stdout {
  font-size: 1.4em;
}
</style>
</div>
<aside class="notes">
<p>freq dist: How many times did an event occur? (e.g.&nbsp;flipping a coin, getting tails)</p>
<p>prob dist: How many times should it have occurred? 50% but also realistic lower and higher values!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="the-uniform-distribution" class="slide level2">
<h2>The Uniform Distribution</h2>
<p>In a <strong>uniform distribution</strong>, each possible outcome has an equal chance of occurring.</p>
<div class="fragment">
<p>If we have a hat with 12 paper slips with names, each name has an equal chance (<span class="math inline">\(p = \frac{1}{12} \approx .08\)</span>) of being drawn:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="W5_Probability_files/figure-revealjs/unnamed-chunk-3-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="the-binomial-distribution" class="slide level2">
<h2>The Binomial Distribution</h2>
<p>The <strong>binomial</strong> (“two categories”) <strong>distribution</strong> is used for <em>discrete</em> data with <em>two</em> possible outcomes (e.g., flipping a coin). It models the number of <em>successes</em> being observed (e.g., heads), given the probability of success (0.5 for fair coins) and the number of observations (flips of a coin, e.g., 10).</p>
<div class="fragment">
<p>How many heads (successes) should we expect and with what probability?</p>
<p>We can simulate 10 coin flips (or dice) each 10.000 times and count the number of heads (out of the 10). We can use this distribution to work out the probability of different outcomes, e.g., getting at least 3 heads (or 6s) out of 10 tosses (dice rolls).</p>
<div class="columns">
<div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="W5_Probability_files/figure-revealjs/unnamed-chunk-4-1.png" width="384"></p>
</figure>
</div>
</div>
</div>
</div><div class="column">
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="W5_Probability_files/figure-revealjs/unnamed-chunk-5-1.png" width="384"></p>
</figure>
</div>
</div>
</div>
</div>
</div></div>
<aside class="notes">
<p>success: whatever you want, also an “artificial” dichotomization like “roll a 6” vs.&nbsp;“roll no 6”</p>
<p>add up probabilities &gt;=3 or 1 - P(X &lt;= 2)</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="the-normal-distribution" class="slide level2">
<h2>The Normal Distribution</h2>
<p>The <strong>normal distribution</strong> is very common in statistics (i.e., in the real world). It (roughly) reflects the probability of any value occurring for a <em>continuous</em> variable, such as height.</p>

<img data-src="images/norm_dist_height.PNG" width="485" class="r-stretch quarto-figure-center"><p class="caption">Normal distribution of height</p><div class="fragment">
<p>The normal distribution is always <em>symmetrical</em><br>
=&gt; equal probability of observations above and below the mean.<br>
=&gt; the mean, median, and mode are all equal!</p>
</div>
</section>
<section id="normal-distribution-2" class="slide level2">
<h2>Normal Distribution 2</h2>
<p>We can also use simulations to approximate a normal distribution. This simulation shows that increasing the sample size will get closer to a normal distribution:</p>

<img data-src="images/normal_dist.gif" class="r-stretch quarto-figure-center"><p class="caption">A simulation of an experiment collecting height data from 5000 participants.</p></section></section>
<section id="r" class="title-slide slide level1 center">
<h1>R</h1>
<p>Open RStudio and load your Biostats R project. Create a new script called <code>Probability.R</code>.</p>
</section>

<section>
<section id="distributions" class="title-slide slide level1 center">
<h1>Distributions</h1>
<p>We are starting with exercises about the three distributions we just got know: uniform, binomial, and normal distribution.</p>
</section>
<section id="using-the-uniform-distribution" class="slide level2 scrollable">
<h2>Using the Uniform Distribution</h2>
<p>We can use <code>runif</code> for a uniform distribution of <em>continuous</em> (numerical) values or<br>
<code>sample</code> for a uniform distribution of <em>discrete</em> (numerical or text) values.</p>
<ol type="1">
<li>Draw a random decimal number between 0 and 1</li>
<li>Draw 100 random decimal numbers between 0 and 10 and calculate their mean.</li>
<li>Draw 50 random <strong>integer</strong> numbers between 1 and 10 and calculate their mean.</li>
<li>Draw who may have the first turn during board game night: Anna, Barbara, Christina, or Dana.</li>
<li>Produce a random order of all the names of Anna, Barbara, Christina, and Dana.</li>
</ol>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="co">#1</span></span>
<span id="cb1-2"><a></a><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>) <span class="co">#default parameters are already set to min=0 and max=1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5621502</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a><span class="co">#2</span></span>
<span id="cb3-2"><a></a><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">100</span>, <span class="at">max=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">mean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.374587</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a><span class="co">#3</span></span>
<span id="cb5-2"><a></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">size=</span><span class="dv">50</span>, <span class="at">replace=</span>T) <span class="sc">%&gt;%</span> <span class="fu">mean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.96</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a><span class="co">#4</span></span>
<span id="cb7-2"><a></a><span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Anna"</span>, <span class="st">"Barbara"</span>, <span class="st">"Christina"</span>, <span class="st">"Dana"</span>), <span class="at">size=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Barbara"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a><span class="co">#5</span></span>
<span id="cb9-2"><a></a><span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Anna"</span>, <span class="st">"Barbara"</span>, <span class="st">"Christina"</span>, <span class="st">"Dana"</span>)) <span class="co">#by default, sample draws all elements in random order</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Barbara"   "Christina" "Anna"      "Dana"     </code></pre>
</div>
</div>
</div>
</section>
<section id="using-the-binomial-distribution" class="slide level2 scrollable">
<h2>Using the Binomial Distribution</h2>
<div class="fragment">
<div class="columns">
<div class="column">
<ul>
<li><code>dbinom()</code>: the <strong>density distribution</strong> gives you the probability of <strong>exactly</strong> <span class="math inline">\(x_i\)</span> successes given the number of trials and the probability of success on a single trial: <span class="math inline">\(P(X = x_i)\)</span> (e.g., what’s the probability of flipping 8/10 heads with a fair coin?)</li>
</ul>
<p><br>
</p>
<ul>
<li><p><code>pbinom()</code>: the <strong>(cumulative) probability distribution</strong> gives you the <em>cumulative</em> probability of getting <strong>a maximum of</strong> <span class="math inline">\(x_i\)</span> successes: <span class="math inline">\(P(X \le x_i)\)</span> (e.g., getting 5 or fewer heads out of 10 flips).</p></li>
<li><p><code>qbinom()</code>: the <strong>quantile function</strong> gives you the number of success (x-axis) corresponding to a given <strong>cumulative</strong> probability: <span class="math inline">\(X(P = P_i)\)</span> (e.g., A maximum of how many heads do you have to expect if you want at least an event probability of 25%?). This is the inverse function of <code>pbinom()</code>.</p></li>
</ul>
<p><strong>Note:</strong> Be aware of the difference between success probability <span class="math inline">\(p\)</span>, the probability of the density distribution <span class="math inline">\(P(X = x_i)\)</span>, and the probability of the cumulative probability distribution <span class="math inline">\(P(X \le x_i)\)</span></p>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="W5_Probability_files/figure-revealjs/unnamed-chunk-7-1.png" width="384"></p>
</figure>
</div>
</div>
</div>
</div></div>
<aside class="notes">
<ol type="1">
<li>What’s the probability of getting exactly 5 heads on 10 flips?</li>
<li>What’s the probability of getting 0 to 2 heads on 10 flips?</li>
<li>What’s the probability of getting at least 8 heads on 10 flips?</li>
</ol>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="using-the-binomial-distribution-2" class="slide level2 scrollable">
<h2>Using the Binomial Distribution 2</h2>
<p>Now in R:</p>
<ol type="1">
<li>What’s the probability of getting exactly 5 heads on 10 flips?</li>
<li>What’s the probability of getting 0 to 2 heads on 10 flips?</li>
<li>What’s the probability of getting at least 8 heads on 10 flips?</li>
</ol>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a><span class="co">#1</span></span>
<span id="cb11-2"><a></a><span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2460938</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a></a><span class="co">#2 (indirect way)</span></span>
<span id="cb13-2"><a></a><span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">prob=</span><span class="fl">0.5</span>) <span class="sc">%&gt;%</span> <span class="fu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0546875</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a></a><span class="co">#2 (direct way)</span></span>
<span id="cb15-2"><a></a><span class="fu">pbinom</span>(<span class="at">q =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>) <span class="co">#P(X &lt;= q)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0546875</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a></a><span class="co">#3 (careful: minus 1)</span></span>
<span id="cb17-2"><a></a><span class="fu">pbinom</span>(<span class="at">q =</span> <span class="dv">8-1</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>, <span class="at">lower.tail =</span> F) <span class="co">#P(X &gt; q) = 1 - P(X &lt;= q)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0546875</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p><strong>Note</strong>: The binomial distribution is only symmetrical for <span class="math inline">\(p = 50\%\)</span>.<br>
That’s why “a maximum of 2 heads” (0, 1, or 2) has the same probability as “at least 8 heads” (8, 9, or 10).</p>
<aside class="notes">
<ul>
<li><p><code>x</code>: the number of ‘heads’ of which we want to know the probability.</p></li>
<li><p><code>size</code>: the number of trials (flips) we are simulating; in this case, 10 flips.</p></li>
<li><p><code>prob</code>: the probability of ‘heads’ on one trial. 50% far a fair coin.</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!--
## Using the Binomial Distribution 3

**Activity 3**: `pbinom()`

What is the probability of getting max. 2 heads out of 10 coin flips?

. . .

We want to know the **cumulative probability** (*max.* **2** heads out of **10**, which includes 0 and 1 - so it is the sum of those three probabilities).

Run this code:


::: {.cell}

```{.r .cell-code}
pbinom(q = 2, size = 10, prob = 0.5)
```

::: {.cell-output .cell-output-stdout}

```
[1] 0.0546875
```


:::

```{.r .cell-code}
# note: before the first argument was x, but here it's called q
```
:::


The probability of getting 2 heads or less is 0.05!

::: notes
show!
:::

## Using the Binomial Distribution 4

Now it's your turn: *What is the probability of getting **7 or more** heads on 10 flips?*

. . .

If we simply put in `q = 7`, we get the probability of everything up to 7 (blue bars in plot). This is not what we want.


::: {.cell}

```{.r .cell-code}
pbinom(q = 7, size = 10, prob = .5) 
```

::: {.cell-output .cell-output-stdout}

```
[1] 0.9453125
```


:::
:::



::: {.cell}
::: {.cell-output-display}
![](W5_Probability_files/figure-revealjs/unnamed-chunk-11-1.png){width=384}
:::
:::


. . .

You might remember from the first (input) lesson on probability that the sum of all probabilities is 1 and you can use this to calculate the "upper" probabilities of 7, 8, 9, and 10 combined. For this, we calculate the probability of getting max. 6 heads and subtract this value from 1:


::: {.cell}

```{.r .cell-code}
1 - pbinom(q = 6, size = 10, prob = .5)
```

::: {.cell-output .cell-output-stdout}

```
[1] 0.171875
```


:::
:::


. . .

Alternatively, we can also hand over another argument to the `pbinom()` function: `lower.tail=FALSE`.


::: {.cell}

```{.r .cell-code}
pbinom(q = 6, size = 10, prob = .5, lower.tail = FALSE)
```

::: {.cell-output .cell-output-stdout}

```
[1] 0.171875
```


:::
:::

## Using the Binomial Distribution 5
-->
</div>
</section>
<section id="using-the-binomial-distribution-3" class="slide level2">
<h2>Using the Binomial Distribution 3</h2>
<p>Now let’s use the <em>quantile function</em> <code>qbinom()</code>!</p>
<p>Imagine a friend wants to bet you on tossing a coin and bets that it will be tails. You suspect she has a coin that is not fair and it will be more likely that it turns up as tails.</p>
<p>Your friend agrees that you can toss the coin 10 times to test it before you have to give your bet.<br>
you want to find out whether the coin is fair and ask yourself: <strong>What is the minimum number of heads that is acceptable if it is fair?</strong></p>
<p>We choose a probability so low that it is unlikely to get a result lower than that if the coin was fair. We will use a typical value for statistical significance: 0.05 (or in 5% of cases we will find a lower value by chance if the coin was fair).</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a></a><span class="fu">qbinom</span>(<span class="at">p =</span> .<span class="dv">05</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p>In this case, the probability of success is now called <code>prob</code> because <code>p</code> is now used for the probability cut-off we want to set. This is unnecessarily confusing :(</p>
</div>
<div class="fragment">
<p>If we run the code, we get a value of 2. This means that 2 heads is the first time that the cumulative probability function reaches <strong>at least</strong> 5% . Thus, if we get <strong>less than</strong> two heads out of the ten tosses, we could conclude that the coin is likely biased (there is only a 5% chance that this would happen if the coin was fair). You would probably not bet with your friend!</p>
</div>
<div class="fragment">
<p><strong>Note:</strong> This is a bad way to test the fairness of a coin (it’s just for illustration of <code>qbinom</code>)! Rather demand that you win at tails (if the coin is fair, your friend shouldn’t mind).</p>
</div>
</section>
<section id="using-the-normal-distribution" class="slide level2">
<h2>Using the Normal Distribution</h2>
<p>For every probability distribution, R provides similar functions starting with <code>d</code>, <code>p</code>, or <code>q</code>. For the normal distribution, those are:</p>
<ul>
<li class="fragment"><p><code>dnorm()</code>: <em>density function</em>, for calculating the <em>density</em> (<strong>not probability!</strong>) of a specific value. Only useful for plotting.</p></li>
<li class="fragment"><p><code>pnorm()</code>: <em>cumulative probability</em> or <em>distribution function</em>, for calculating the probability of getting at least (or at most) a specific value.</p></li>
<li class="fragment"><p><code>qnorm()</code>: <em>quantile function</em>, for calculating the specific value associated with a given cumulative probability.</p></li>
</ul>
<div class="fragment">
<p>For the next activities, we will use means and SDs of height from the Scottish Health Survey (2008).</p>
</div>
</section>
<section id="using-the-normal-distribution-2" class="slide level2">
<h2>Using the Normal Distribution 2</h2>
<p>Calculate the probability of meeting a Scottish woman who is as tall or taller than the average Scottish man.</p>
<p>Which function would you use?</p>
<p><em>Hint</em>: You want to know how likely it is that you get a value as extreme or extremer than a specific value (the average height of men) within the distribution for women.</p>
<p>What we know:</p>
<ul>
<li><p>average female height = 163.8, SD = 6.931</p></li>
<li><p>average male height = 176.2, SD = 6.748</p></li>
<li><p>We want to know “at least as tall as”</p></li>
</ul>
<div class="fragment">
<p>We need the <code>pnorm()</code> function. Fill in the values instead of the <code>NULL</code>s.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a></a><span class="fu">pnorm</span>(<span class="at">q =</span> <span class="cn">NULL</span>, <span class="at">mean =</span> <span class="cn">NULL</span>, <span class="at">sd =</span> <span class="cn">NULL</span>, <span class="at">lower.tail =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a></a><span class="fu">pnorm</span>(<span class="at">q =</span> <span class="fl">176.2</span>, <span class="at">mean =</span> <span class="fl">163.8</span>, <span class="at">sd =</span> <span class="fl">6.931</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03680228</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p><strong>Note</strong>: For continuous distributions, we don’t have to distinguish between “taller than” and “at least as tall”. <span class="math inline">\(P(X \le x_i) = P(X &lt; x_i)\)</span>! (Because the probability of one specific value like 176.2000000 m is exactly 0)</p>
</div>
<div class="fragment">
<p><strong>Also note</strong>: The SD of the distribution of males is not relevant for this question.</p>
<aside class="notes">
<p>Don’t do this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a></a><span class="fu">pnorm</span>(<span class="at">q =</span> <span class="fl">176.2</span>, <span class="at">mean =</span> <span class="fl">163.8</span>, <span class="at">sd =</span> <span class="fl">6.931</span>, <span class="at">lower.tail =</span> F) <span class="sc">+</span> </span>
<span id="cb24-2"><a></a>  <span class="fu">dnorm</span>(<span class="at">x =</span> <span class="fl">176.2</span>, <span class="at">mean =</span> <span class="fl">163.8</span>, <span class="at">sd =</span> <span class="fl">6.931</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04841892</code></pre>
</div>
</div>
<p>You cannot add a probability and a density together! Just <code>pnorm(q = 176.2, mean = 163.8, sd = 6.931, lower.tail = F)</code> is the correct answer!</p>
<p>When we say “What’s the probability of a woman being 1.80 m tall?”, we actually mean: “What’s the probability of a person being <strong>between 1.795 and 1.805</strong> m tall?” (since height is usually measured within steps of 1 cm). We can calculate this, e.g.&nbsp;for Scottish women, using: <code>pnorm(q = 180 + c(-.5, .5), mean = 163.8, sd = 6.931) %&gt;% diff()</code> = 0.3%</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="using-the-normal-distribution-3" class="slide level2">
<h2>Using the Normal Distribution 3</h2>
<p>Fiona is a very tall Scottish woman (181.12 cm) who will only date men who are as tall or taller than her. What is the probability of Fiona finding a taller man?</p>
<p>What we know:</p>
<ul>
<li><p>average female height = 163.8, SD = 6.931</p></li>
<li><p>average male height = 176.2, SD = 6.748</p></li>
<li><p>We want to know “tall or taller”</p></li>
<li><p>Fiona’s height = 181.12</p></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a></a><span class="fu">pnorm</span>(<span class="at">q =</span> <span class="fl">181.12</span>, <span class="at">mean =</span> <span class="fl">176.2</span>, <span class="at">sd =</span> <span class="fl">6.748</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2329687</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p><strong>Conclusion</strong>: Fiona shrinks her dating pool to roughly a quarter and may thus consider abandoning beauty standards imposed by society. (Same advice for men, of course)</p>
</div>
<div class="fragment">
<p><br>
</p>
<p>How tall would a Scottish man have to be in order to be in the tallest 5% of the height distribution for Scottish men?</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a></a><span class="fu">qnorm</span>(<span class="at">p =</span> .<span class="dv">05</span>, <span class="at">mean =</span> <span class="fl">176.2</span>, <span class="at">sd =</span> <span class="fl">6.748</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 187.2995</code></pre>
</div>
</div>
</div>
</section></section>
<section id="thanks" class="title-slide slide level1 center">
<h1>Thanks!</h1>
<p><strong>Learning objectives</strong>:</p>
<ul>
<li><p>Understand different concepts of probability:</p>
<ul>
<li><p>joint and conditional probability</p></li>
<li><p>statistical independence</p></li>
<li><p>Bayes’ Theorem</p></li>
<li><p>probability distributions</p></li>
</ul></li>
<li><p>Understand and use different probability distributions in R</p></li>
</ul>
<p><strong>Next</strong>:</p>
<ul>
<li>Sampling and resampling/simulations</li>
</ul>


</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,

        height: 720,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/Hillea\.github\.io\/biostats\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>